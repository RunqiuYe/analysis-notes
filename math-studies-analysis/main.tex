\documentclass[a4paper]{article}
\usepackage{parskip}
\usepackage{lipsum}

\def\nterm {Spring}
\def\nyear {2025}
\def\ncourse {Mathematical Studies Analysis}

\input{../header}

\newcommand{\TODO}{\textcolor{red}{\textbf{*** TO-DO ***}}}

\begin{document}
\maketitle

\tableofcontents

\section{Advanced topics in metric space theory}

\subsection{Baire category}

\begin{defi}
Let $X$ be a metric space.  
\begin{enumerate}
 \item We say that $E \subset X$ is nowhere dense if 
 $(\bar{E})^\circ = \varnothing$.
 \item We say that $E \subset X$ is meager in $X$ if 
\begin{equation*}
 E = \bigcup_{\alpha \in A} E_\alpha,
\end{equation*}
where $A$ is a countable set and $E_\alpha \subset X$ 
is nowhere dense for every $\alpha \in A$.
\end{enumerate}
\end{defi}

\begin{thm}
Prove that the following are equivalent for  
$E \subset X$:
\begin{enumerate}
 \item $E$ is nowhere dense
 \item $\bar{E}$ is nowhere dense
 \item $(\bar{E})^c$ is open and dense in $X$.
\end{enumerate}
\end{thm}

\begin{proof}
  (1) $\implies$ (2). Suppose $E$ is nowhere dense, then 
  $(\bar{E})^\circ = \emptyset$. Note that the closure 
  of $\bar{E}$ is just $\bar{E}$ itself. It follows that 
  $\bar{E}$ is also nowhere dense. 
  
  (2) $\implies$ (3). Suppose $\bar{E}$ is nowhere dense.
  Note that $\bar{E}$ is closed, so $(\bar{E})^c$ is open.
  Let $x \in X$ be arbitrary. Since $\bar{E}$ is nowhere dense,
  $x \notin (\bar{E})^\circ$. This implies that for arbitrary 
  $\epsilon > 0$, we have $B(x, \epsilon) \nsubset \bar{E}$.
  This is equivalent to $B(x, \epsilon) \cap (\bar{E})^c \neq 
  \emptyset$. Hence, $(\bar{E})^c$ is dense in $X$. 

  (3) $\implies$ (1). Suppose $(\bar{E})^c$ is dense in $X$. 
  Let $x \in X$ and $\epsilon > 0$ be arbitrary. It follows 
  that $B(x, \epsilon) \cap (\bar{E})^c \neq \emptyset$. 
  This is equivalent to $B(x, \epsilon) \nsubset \bar{E}$. 
  Therefore, $(\bar{E})^\circ = \emptyset$ and $E$ is nowhere 
  dense.

\end{proof}

\begin{thm}[Baire category theorem]
Let $X$ be a complete metric space.  Suppose that for each 
$n \in \N$, $U_n \subset X$ is open and dense in $X$. 
Prove that $\bigcap_{n=0}^\infty U_n$ is dense in $X$.  
Hint: use the shrinking closed set property.
\end{thm}

\begin{proof}
  Consider any $x \in X$ and arbitrary $\epsilon > 0$, it
  suffices to show that $U_n \cap B(x, \epsilon)
  \neq \emptyset$ for each $n \in \N$. 
  Now inductively choosing a sequence 
  $x_i \in X$ and $\epsilon_i > 0$ such that 
  for each $i \in \N$, $B[x_i, \epsilon_i] \subset U_i$,
  $B[x_{i+1}, \epsilon_i] \subset B[x_i, \epsilon_i]
  \subset B(x, \epsilon)$, and $\epsilon_i < 2^{-i} \epsilon$.
  
  Since $U_0$ is dense in $X$,
  $B(x, \epsilon) \cap U_0 \neq \emptyset$.
  Note that both $U_0$ and $B(x, \epsilon)$ are open, so
  we can choose $x_0 \in B(x, \epsilon) \cap U_0$ 
  and $\epsilon_0 > 0$ so small 
  that $B[x_0, \epsilon_0] \subset B(x, \epsilon) \cap U_0$
  and $\epsilon_0 < \epsilon$. 
  Now suppose 
  for $0 \leq i \leq n$, we have chosen $x_i \in X$ 
  and $\epsilon_i > 0$ such that 
  $B[x_i, \epsilon_i] \subset U_i$ 
  and $\epsilon_i < 2^{-i} \epsilon$ 
  for all $0 \leq i \leq n$,
  $B[x_{i+1}, \epsilon_{i+1}] \subset 
  B[x_i, \epsilon_i]$ for all $0 \leq i < n$.
  Since $U_{n+1}$ is dense in $X$, $B(x_n, \epsilon_n)
  \cap U_{n+1} \neq \emptyset$. Note also both $U_{n+1}$ 
  and $B(x_n, \epsilon_n)$ are open.
  Therefore, choose 
  $x_{n+1} \in B(x_n, \epsilon_n) \cap U_{n+1}$ and 
  $\epsilon_{n+1} > 0$ so small that 
  $B[x_{n+1}, \epsilon_{n+1}] \subset B(x_n, \epsilon_n) 
  \cap U_{n+1}$ and $\epsilon_{n+1} < \frac{\epsilon_n}{2}$. 
  It follows that 
  $B[x_{n+1}, \epsilon_{n+1}] \subset U_{n+1}$ and 
  $B[x_{n+1}, \epsilon_{n+1}] \subset B[x_n, \epsilon_n]
  \subset B(x, \epsilon)$. Also, 
  $\epsilon < \frac{\epsilon_n}{2} < 2^{-n-1} \epsilon$.
  Now we have successfully constructing the desired sequence.
  
  Since $X$ is complete, $\bigcap_{n=0}^\infty B[x_n, \epsilon_n]
  = \left\{ z \right\}$ for some $z \in X$. Note that 
  for each $n$, we have $z \in B[x_n, \epsilon_n] \subset U_n$. 
  Also,
  $z \in B[x_n, \epsilon_n] \subset B(x, \epsilon)$. 
  Therefore, $z \in U_n \cap B(x, \epsilon)$ for each $n \in \N$
  and $\bigcap_{n=0}^\infty U_n$ is dense in $X$.

\end{proof}

\begin{remark}
    An equivalent statement of the theorem is the following: \\
    Let $X$ be a complete metric space and $\{C_n\}$ a countable 
    collection of closed subsets of $X$ such that $X = 
    \bigcup_{n \in \N} C_n $. Then at least one of the $C_n$ 
    contains an open ball.
\end{remark}

\subsection{Open mapping theorem}

\subsubsection*{Linear surjections}

\begin{thm}[Open mapping theorem]
Let $X,Y$ be Banach spaces over a common field and assume that 
$T \in \L(X;Y)$.  Prove that the following are equivalent.
\begin{enumerate}
 \item $T$ is surjective.
 
 \item There exists $\delta >0$ such that $B_Y(0,\delta) \subset 
 \overline{T(B_X(0,1))}$.
 
 \item For every $\epsilon >0$ there exists $\delta >0$ 
 such that $B_Y(0,\delta) \subset T(B_X(0,\ep))$.
 
 \item $T$ is an open map: if $U\subset X$ is open, then 
 $T(U) \subset Y$ is open.

  \item There exists $C \ge 0$ such that for each $y \in Y$ 
  there exists $x \in X$ such that $Tx=y$ and 
\begin{equation*}
 \norm{x}_X \le C \norm{y}_Y.
\end{equation*}
\end{enumerate}
HINT: Prove that  $(1) \implies (2) \implies (3) 
\implies (4) \implies (5)  \implies (1)$, keeping 
in mind the following suggestions.  
\begin{enumerate}
 \item For (1) $\implies$ (2): Study the sets $C_n = 
 \overline{T(B_X(0,n))} \subset Y$ for $n \ge 1$.
 \item For (2) $\implies$ (3):  Prove that 
 $\overline{T(B_X(0,1)  )} \subset T(B_X(0,3))$ 
 by considering $y \in\overline{T(B_X(0,1)  )}$ and  
 inductively constructing $\{x_j\}_{j=0}^\infty \subset X$
such that $\norm{x_j}_X < 2^{-j}$ and 
$y - \sum_{j=0}^m T x_j \in B_Y(0,2^{-m-1} R)$  
for all $m \in \N$.
\end{enumerate}
\end{thm}

\begin{proof}
  (1) $\implies$ (2). Following the hint, for $n \geq 1$ let 
  $C_n = \bar{T(B_X(0, n))}$. Then each of the $C_n$ are closed.
  Since $T$ is surjective, $Y = \bigcup_{n=1}^\infty C_n$. 
  Suppose for contradiction that each $C_n$ are nowhere dense.
  It then follows that $C_n^c$ are dense in $Y$. By Baire Category
  Theorem, $\bigcap_{n=1}^\infty C_n^c$ is dense in $Y$. However,
  $\bigcap_{n=1}^\infty C_n^c = \left( \bigcup_{n=1}^\infty C_n \right)^c 
  = \emptyset$, a contradiction. Therefore, at least one $C_n$
  is not nowhere dense. That is, there exists some $n \geq 1$, 
  $\bar{T(B_X(0, n))}$ contains an open ball. However, 
  this is the same set as $n \bar{T(B_X(0, 1))}$. Therefore, 
  $\bar{T(B_X(0, 1))}$ contains an open ball $B_Y(y_0, 4 r)$
  for some $y_0 \in Y$ and $r > 0$.

  Let $y_1 = T x_1$ for some $x_1 \in B_Y(0,1)$ such that 
  $\norm{y_0 - y_1} < 2 r$. It follows that 
  $B_Y(y_1, 2 r) \subset B_Y(y_0, 4 r) \subset \bar{T(B_X(0,1))}$. 
  For any $y \in Y$ such that 
  $\norm{y} < r$, we have 
  \[
  y = -\frac{1}{2} y_1 + \frac{1}{2} (2 y + y_1) = 
  - T \left( \frac{x_1}{2} \right) + \frac{1}{2} (2 y + y_1).
  \]
  However, notice that 
  \[
  \frac{1}{2} (2 y + y_1) \subset \frac{1}{2} B_Y(y_1, 2r) 
  \subset \frac{1}{2} \bar{T(B_X(0, 1))} 
  = \bar{T(B_X(0, \tfrac{1}{2}))} .
  \]
  It follows that 
  \[
  y = - T \left( \frac{x_1}{2} \right) + \frac{1}{2} (2 y + y_1)
  \in - T \left( \frac{x_1}{2} \right) + \bar{T(B_X(0, \tfrac{1}{2}))}.
  \]
  Note that $- T(\frac{x_1}{2}) \in T(B_X(0, \frac{1}{2}))$. Therefore, 
  $y \in \bar{T(B_X(0, 1))}$. Since $y$ is arbitrary with 
  $\norm{y} < r$, we have $B_Y(0, r) \subset \bar{T(B_X(0,1))}$.

  (2) $\implies$ (3). Following the hint, we first show 
  $\bar{T(B_X(0, 1))} \subset T(B_X(0, 3))$.
  By assumption, we have 
  $B_Y(0, R) \subset \bar{T(B_X(0, 1))}$ for some $R > 0$. 
  It follows from homogeneity that for each $m \in \N$, we have 
  \[
    2^{-m} B_Y(0, R) = B_Y(0, 2^{-m} R) \subset 
    2^{-m} \bar{T(B_X(0, 1))} = \bar{T(B_X(0, 2^{-m}))}.
  \]
  Let 
  $y \in \bar{T(B_X(0, 1))}$ and pick $x_0 \in X$ with 
  $\norm{x} < 1$ such that $\norm{y - Tx} < 2^{-1} R$. Now 
  suppose we have chosen $x_j$ for $0 \leq j \leq m$ such that 
  $\norm{x_j} < 2^{-j}$ and $y - \sum_{j=0}^m T x_j \in B_Y(0, 
  2^{-m - 1} R) $ for all $m \in \N$. By the inclusion above, 
  we can pick $x_{m+1} \in X$ with $\norm{x_{m+1}} 
  < 2^{-m-1}$ such that
  \[
  \norm{y - \sum_{j=0}^m T x_j - T x_{m+1}} 
  = \norm{y - \sum_{j=0}^{m+1} T x_j} < 2^{-m-2} R.
  \]
  Therefore, $y - \sum_{j=0}^{m+1} T x_j \in B_Y(0, 2^{-m-2}) R$.
  This completes the inductive construction, and we have
  found a sequence $\left\{ x_j \right\}$ such that 
  $\norm{x_j} < 2^{-j}$ and 
  $y - \sum_{j=0}^m T x_j \in B_Y (0, 2^{-m-1} R)$
  for each $m \in \N$. Note that 
  \[
  \sum_{j=0}^\infty \norm{x_j} \leq \sum_{j=0}^{\infty} 2^{-j} 
  = 2,
  \]
  so $\sum_{j=0}^\infty x_j$ converges absolutely. Since $X$ 
  is Banach, $\sum_{j=0}^\infty x_j$ converges
  to some $x \in X$ with $\norm{x} \leq 2$. Also, since 
  $y - \sum_{j=0}^m T x_j \in B_Y(0, 2^{-m-1}R)$, taking the
  limit where $m$ approaches infinity we obtain 
  \[
  y = \sum_{j=0}^\infty T x_j = T \left( \sum_{j=0}^\infty x_j \right)
  = T x.
  \]
  Therefore, $y \in T(B_X(0, 3))$ and thus $\bar{T(B_X(0, 1))}
  \subset T(B_X (0,3))$.

  Now for every $\epsilon > 0$, we have 
  $\frac{\epsilon}{3} \bar{T(B_X(0, 1))} \subset \frac{\epsilon}{3}
  T(B_X(0, 3)) = T(B_X(0, \epsilon))$. By assumption, there exists
  $\delta > 0$ such that $B_Y(0, \delta) \subset \bar{T(B_X(0, 1))}$.
  Therefore,
  \[
  B_Y \left( 0, \frac{\delta \epsilon}{3} \right) = \frac{\epsilon}{3} 
  B_Y(0, \delta) \subset \frac{\epsilon}{3} \bar{T(B_X(0, 1))}
  \subset T(B_X(0, \epsilon)).
  \]

  (3) $\implies$ (4). Let $U \subset X$ be open and $y \in T(U)$.
  There exists $x \in U$ such that $T x = y$. Since $U$ is open,
  there exists $\epsilon > 0$ such that $B_X(x, \epsilon)
  \subset U$. By assumption, there exists $\delta > 0$
  such that $B_Y(0, \delta) \subset T(B_X(0, \epsilon))$.
  It follows that 
  \[
  B_Y(y, \delta) = y + B_Y(0, \delta) \subset Tx + T(B_X(0, \epsilon)) 
  = T(x + B_X(0, \epsilon)) \subset T(U).
  \]
  Therefore, $T(U)$ is open and $T$ is an open map.

  (4) $\implies$ (5). Since $T$ is an open map, $T(B_X(0, 1))$ is 
  open. Also, $T(0) = 0$ so there exists $r > 0$ such that 
  $B_Y(0, r) \subset T(B_X(0, 1))$. Now let $y \in Y$. Then, 
  $\frac{r}{2 \norm{y}} y \in B_Y(0, r)$ and there exists 
  $x \in B_X(0, 1)$ such that $Tx = \frac{r}{2 \norm{y}} y$. 
  It follows that 
  \[
  T \left( \frac{2\norm{y}}{r} x \right) = y,
  \]
  and since $x \in B_X(0, 1)$,
  \[
  \norm{\frac{2 \norm{y}}{r} x} = \frac{2 \norm{y} \norm{x}}{r}
  < \frac{2}{r} \norm{y}.
  \]
  Letting $C = \frac{2}{r}$ completes the proof.

  (5) $\implies$ (1). Since for each $y \in Y$ there exists 
  $x \in X$ such that $T x = y$, $T$ is surjective.

\end{proof}

\subsubsection*{Linear homeomorphisms, norm equivalence, 
and closed graphs}
\begin{thm}
  Let $X$ and $Y$ be Banach spaces and suppose that 
  $T \in \L(X,Y)$ is a bijection.  Prove that $T^{-1} 
  \in \L(Y,X)$, and in particular $T$ is a linear 
  (and thus bi-Lipschitz) homeomorphism.
\end{thm}

\begin{proof}
  Since $T \in \L(X, Y)$ is a bijection, $T$ is a surjection. 
  It follows that $T$ is an open map. In particular, for any 
  $U \subset X$ open, $T(U) = (T^{-1})^{-1}(U)$ is open. Therfore,
  $T^{-1}$ is continuous and thus $T$ is a linear homeomorphism.

\end{proof}

\begin{thm}
Let $X$ be a vector space that is complete when equipped 
with both of the norms $\norm{\cdot}_1$ and 
$\norm{\cdot}_2$.  Prove that if there exists a constant 
$C_1>0$ such that $\norm{x}_2 \le C_1 \norm{x}_1$ for all 
$x \in X$, then there exists a constant $C_0 >0$ such that 
$C_0 \norm{x}_1 \le \norm{x}_2 \le C_1 \norm{x}_1$ for all 
$x \in X$.    
\end{thm}

\begin{proof}
Let $T: X_1 \to X_2$, where $X_1$ and $X_2$
are $X$ equipped with norms $\norm{\cdot}_1$ and $\norm{\cdot}_2$,
respectively, be the identity map. Then for any $x \in X$ 
with $\norm{x}_1 = 1$, we have 
\[
\norm{T x}_2 = \norm{x}_2 \leq C_1 \norm{x}_1 = C_1.
\]
Therefore, $T \in \L(X_1, X_2)$. $T$ is also surjective.
Therefore, there exists a constant $C \geq 0$ such that 
each $\norm{x}_1 \leq C \norm{x}_2$. Hence, for each 
$x \in X$
\[
\frac{1}{C} \norm{x}_1 \leq \norm{x}_2 \leq C_1 \norm{x}_1.
\]
Letting $C_0 = \frac{1}{C}$ completes the proof.

\end{proof}

\begin{thm}
    Let $X$ and $Y$ be Banach spaces and let $T : X \to Y$ 
    be linear (just the algebraic condition).  
    Prove that the following are equivalent
\end{thm}
\begin{enumerate}
\item $T$ is continuous, i.e. $T \in \L(X;Y)$.
\item The graph of $T$, $\Gamma(T) = \{(x,Tx) : x \in X\} 
\subset X \times Y$, is closed in $X \times Y$, where 
$X \times Y$ is endowed with any of the usual $p$-norms.
\end{enumerate}

\begin{proof}
  (a) $\implies$ (b). Let $\left\{ (x_n, T x_n) \right\}$ be a convergent sequence 
  in $\Gamma(T)$. Since $X$ is Banach, $x_n \to x$ for some $x \in X$.
  Since $T \in \L(X ; Y)$, we have 
  \[
  \lim_{n \to \infty} T x_n = T \left( \lim_{n \to \infty} x_n \right) = T x.
  \]
  Therefore, $(x_n, T x_n) \to (x, T x) \in \Gamma(T)$, and thus 
  $\Gamma(T)$ is closed.

  (b) $\implies$ (a). Let $\pi_1 : \Gamma(T) \to X$ and 
  $\pi_2 : \Gamma(T) \to Y$ by 
  $\pi_1 (x, T x) = x$ and $\pi_2 (x, T x) = Tx$. Since 
  $\Gamma(T)$ is a closed in Banach space $Y$, 
  $\Gamma(T)$ is Banach space. It is clear that both $\pi_1$
  and $\pi_2$ are bounded linear maps. Moreover, $\pi_1$ is a 
  bijection. It follows that $S = \pi_1^{-1}$ is a bounded linear 
  map. Therefore, $T = \pi_2 \circ S$ is a bounded linear map. 

\end{proof}

\subsubsection*{Linear injections with closed range}
\begin{thm}
    Let $X$ and $Y$ be Banach spaces and $T \in \L(X,Y)$.  
    Prove the following are equivalent.
\begin{enumerate}
 \item $T$ is injective and $\ran(T)$ is closed.
 \item $T : X \to \ran(T)$ is a linear homeomorphism.
 \item There exists $C\ge 0$ such that $\norm{x}_X \le C 
 \norm{Tx}_Y$ for all $x \in X$.
\end{enumerate}
HINT: Prove that $(1) \implies (2) \implies (3) \implies 
(1)$.
\end{thm}

\begin{proof}
  (1) $\implies$ (2). If $T$ is injective and $\ran(T)$ is closed,
  then $\Gamma(T) = \left\{ (x, Tx) : x \in X \right\}$ is closed in 
  $X \times Y$. Therefore, $T : X \to \ran (T)$ is a bounded linear 
  map. Since $T$ is injective, this map is actually bijective from 
  $X$ to $\ran (T)$. Therefore, $T$ is a linaer homeomorphism. 

  (2) $\implies$ (3). Since $T$ is a bijective bounded linear map,
  from $X$ to $\ran(T)$. There exists a contant $C \geq 0$
  such that for each $y \in \ran(T)$ there exists 
  a unique $x \in X$ such that $T x = y$ and $\norm{x} \leq
  C \norm{y} = C \norm{T x}$. Since $T$ is a bijection, 
  $\norm{x} \leq C \norm{T x}$ for all $x \in X$. 

  (3) $\implies$ (1). Let $x \in X$ be such that $T x = 0$.
  It follows that $\norm{x} \leq C \norm{T x} = 0$. Therefore, 
  $x = 0$ and $T$ is injective. To show that 
  $\ran(T)$ is closed, consider a convergent sequence 
  $\left\{ y_n \right\} \subset \ran(T)$ with 
  $y_n = T x_n$. Since for any $n, m \in \N$ we have 
  \[
  \norm{x_n - x_m} \leq C \norm{T (x_n - x_m)} = C \norm{y_n - y_m},
  \]
  $\left\{ x_n \right\}$ is Cauchy. Since $X$ is Banach, 
  $x_n \to x$ for some $x \in X$. Therefore, for 
  all $n \in \N$ we have
  \[
  \norm{y_n - T x} = \norm{T (x_n - x)} \leq \norm{T} \norm{x_n - x},
  \]
  and $y_n \to T x$. Hence, $\ran(T)$ is closed and the proof is
  complete.

\end{proof}

\begin{thm}
  Let $X$ and $Y$ be Banach spaces over a common field. 
  Then, the following subsets of $\L(X; Y)$ are open:
  \begin{enumerate}
    \item $\left\{ T \in \L(X; Y) : \text{$T$ is surjective} \right\}$,
    \item $\left\{ T \in \L(X; Y) : \text{$T$ is injective with closed range} \right\}$,
    \item $\H(X; Y) = \left\{ T \in \L(X; Y) : \text{$T$ is a homeomorphism} \right\}$.
  \end{enumerate}
\end{thm}

\begin{proof}
\begin{enumerate}
\item Let $T \in \L(X; Y)$ be surjective. By open mapping 
theorem, there is $\delta > 0$ such that $B_Y(0, \delta) 
\subset TB_X(0, 1)$. By homogeneity we have 
$B_Y(0, r) \subset TB_X(0, \alpha r)$ for all $r > 0$ where 
$\alpha = \delta^{-1}$. Now let $S \in \L(X; Y)$ be such that 
$\norm{T - S} < \beta < (2\alpha)^{-1}$. Claim $S$ is surjective.

Let $y \in Y$, inductively construct sequences $\left\{ x_n \right\}$
and $\left\{ y_n \right\}$. First let $y_0 = y$. Then,
$\norm{y_0} \in B(0, 2\norm{y_0})$. Select 
$x_0 \in X$ be such that $T x_0 = y_0$ and $\norm{x_0} 
\leq 2 \alpha \norm{y_0}$. Suppose we have selected $y_i$,
$x_i$ for $0 \leq i \leq n$. Set $y_{n+1} = y_n - S x_n$
and select $x_{n+1}$ be such that $T x_{n+1} = y_{n+1}$
and $\norm{x_{n+1}} \leq 2\alpha \norm{y_{n+1}}$.
Then, we have 
\[
\norm{y_{n+1}} = \norm{T x_n - S x_n} \leq
\norm{T - S} \norm{x_n} < 2 \alpha\beta \norm{y_n}
\]
and 
\[
\norm{x_{n+1}} = 2 \alpha \norm{y_{n+1}} \leq
2 \alpha \norm{T - S} \norm{x_n} < 2 \alpha \beta \norm{x_n}.
\]
Note that $2 \alpha\beta < 1$ and $X$ is Banach, define 
\[
x = \sum_{n=0}^\infty x_n = \lim_{N \to \infty} 
\sum_{n = 0}^N x_n.
\]
Also note that $\lim_{n \to \infty} y_n = 0$. It follows 
that 
\[
S x = \sum_{n=0}^\infty S x_n 
= \sum_{n=0}^\infty (y_n - y_{n+1})
= y_0 - \lim_{n \to \infty} y_{n+1} = y.
\]
Therefore $S$ is surjective and the set of surjective 
bounded linear maps are open.

\item Suppose $T \in \L(X; Y)$ is injective with closed range.
Then, closed range theorem gives $C > 0$ such that 
$\norm{x} \leq C \norm{T x}$ for all $x \in X$. Now supose 
$S \in \L(X; Y)$ is such that $\norm{T - S} < (2C)^{-1}$.
Claim that $S$ is also injective with closed range. Indeed,
\[
\begin{aligned}
  \norm{x} &\leq C\norm{T x} \leq C \norm{Sx} + C \norm{(T-S)x} \\
  & \leq C \norm{Sx} + \frac{1}{2}\norm{x}.
\end{aligned}
\]
This shows that $\norm{x} \leq 2C \norm{Sx}$ for all $x \in X$.
By closed range theorem, $S$ is injective with closed range.
This implies that the set of injective bounded linear operator
with closed range is open.

\item This directly follows from 
\[
\H(X; Y) = \left\{ T \in \L(X; Y) : \text{$T$ is surjective} \right\} 
\cap \left\{ T \in \L(X; Y) : \text{$T$ is injective with closed range} \right\}.
\]
\end{enumerate}

\end{proof}

\begin{thm}
Let $X$ and $Y$ be Banach spaces over a common field. Then the following holds.
\begin{enumerate}
\item The sets 
\[
\L_R(X; Y) = \left\{ T \in \L(X; Y) : \text{there exists $S \in \L(Y; X)$ such that $ST = I_X$} \right\}
\]
and 
\[
\L_L(X; Y) = \left\{ T \in \L(X; Y) : \text{there exists $S \in \L(Y; X)$ such that $TS = I_Y$} \right\}
\]
are open.
\item The following inclusion holds: 
\[
\L_L(X; Y) \subset \left\{ T \in \L(X; Y) : \text{$T$ is surjective} \right\}
\]
and 
\[
\L_R(X; Y) \subset \left\{ T \in \L(X; Y) : \text{$T$ is injective with closed range} \right\}.
\]
\item The sets $\L_L(X; Y) \setminus \L_R(X; Y)$ and $\L_R(X; Y) \setminus \L_L(X; Y)$ are open.
\end{enumerate}
\end{thm}

\begin{proof}
\begin{enumerate}
\item Let $T_0 \in \L_R$ and $S_0 \in \L(Y; X)$ be such that 
$T_0 S_0 = I_Y$. Note that $I_X \in \H(X)$ and when $\norm{P} < 1$
for $P \in \L(X)$, we have $I_X + P \in \H(X)$. Suppose now 
$T \in \L(X; Y)$ and $\norm{T} < \norm{S_0}^{-1}$. It follows that 
$I_X + S_0 T \in \H(X)$. For such $T$, we then have 
\[
T_0 + T = T_0 (I_X + S_0 T).
\]
Also, 
\[
(T_0 + T) (I_X + S_0 T)^{-1} S_0 = T_0 (I_X + S_0 T) (I_X + S_0 T)^{-1} S_0
= T_0 S_0 = I_Y.
\]
Therefore, $T_0 + T \in \L_R$ for $T \in B(T_0, \norm{S_0}^{-1})$ 
and $\L_R$ is open.

Now let $T_0 \in \L_L$ and $S_0 \in \L(Y; X)$ be such that 
$S_0 T_0 = I_X$. Again, for $T \in \L(X; Y)$ with 
$\norm{T} < \norm{S_0}^{-1}$, we have 
\[
T_0 + T = (I_X + T S_0) T_0.
\]
and 
\[
S_0 (I_X + T S_0)^{-1} (T_0 + T) = I_X.
\]
Therefore, $\L_R$ is also open.

\item Let $T \in \L_R$ and $S \in \L(Y; X)$ be such that 
$TS = I_Y$. Then for any $y \in Y$ let $x = Sy$. It follows 
that $Tx = TSy = y$. Also, $\norm{x} \leq \norm{S} \norm{y}$
so the 4th item in open mapping theorem guarantees that $T$ is 
surjective. Hence, $\L_L \subset \left\{ T \in \L(X; Y) :  
\text{$T$ is surjective}\right\}$.

Now let $T \in \L_L$ and $S \in \L(Y; X)$ such that 
$ST = I_X$. Now for any $x \in X$, we have $\norm{x} 
= \norm{STx} \leq \norm{S} \norm{Tx}$. Then the closed 
range theorem guarantees that $T$ is injective with closed 
range. Hence, $\L_R \subset \left\{ T \in \L_R(X; Y) : 
\text{$T$ is injective with closed range} \right\}$.

\item \TODO
\end{enumerate}

\end{proof}

\subsection{Hahn-Banach theorem and duality}

\begin{thm}[Hahn-Banach theorem in $\R$]
Let $X$ be a real vector space and suppose $p: X \to \R$ 
is such that 
\[
p(tx + (1-t)y) \leq t p(x) + (1 - t) p (y)
\]
for all $t \in [0,1]$ and $x, y \in X$. 

Suppose $Y$ subspace of $X$ and $l: Y \to \R$ is a linear map 
such that $l \leq p$ on $Y$. Then there exists linear map $L: 
X \to \R$ such that $L \leq p$ on $X$ and $L = l$ on $Y$.
\end{thm}

\begin{proof}
  
Let 
\[
P = \left\{ (Z, \lambda): \text{ 
  $Y \subset Z \subset X$, 
$\lambda$ linear functional on $Z$, $\lambda \leq p$ 
on $Z$ and $l = \lambda$ on $Y$} \right\}
\]
Define partial order $(Z_1, \lambda_1) \preceq (Z_2, \lambda_2)$
if and only if $Z_1 \subset Z_2$ and $\lambda_1 = \lambda_2$
on $Z_1$. It is easy to verify that this is a partial order.
Towards using Zorn's Lemma, let $C \subset P$ be a chain and 
define 
\[
\begin{aligned}
  U = \bigcup_{(Z, \lambda) \in C} Z, \qquad 
  \Lambda = \bigcup_{(Z, \lambda) \in C} \lambda.
\end{aligned}
\]
It is easy to verify that 
$(U, \Lambda)$ is an upper bound for the chain.
By Zorn's Lemma, $P$ has a maximal element $(M, L)$. 
It remains to show thta $M = X$. 

Suppose for contradiction that $M \neq X$. Pick $x_0 \in X 
\setminus M$. For any $x, y \in M$, we have 
\[
\begin{aligned}
\beta L(x) + \alpha L(y) 
&= L(\beta x + \alpha y) \\ 
&= \frac{1}{\alpha + \beta} L \left( 
  \frac{\beta}{\alpha + \beta} x + \frac{\alpha}{\alpha + \beta} y 
 \right)\\ 
& \leq (\alpha + \beta) p \left( 
  \frac{\beta}{\alpha + \beta} x + \frac{\alpha}{\alpha + \beta} y 
 \right)\\ 
&= (\alpha + \beta) p \left( 
  \frac{\beta}{\alpha + \beta} (x - \alpha x_0)
  + \frac{\alpha}{\alpha + \beta} (y + \beta x_0) 
 \right)\\ 
& \leq \beta p(x - \alpha x_0) + \alpha p(y + \beta x_0).
\end{aligned}
\]
This implies that 
\[
\sup_{\substack{x \in M \\ \alpha > 0}} 
\frac{1}{\alpha} \left[ L(x) - p(x - \alpha x_0) \right] 
\leq \inf_{\substack{y \in M \\ \beta > 0}} 
\frac{1}{\beta} \left[ p(y + \beta x_0) - L(y) \right].
\]
Note that $-p(-x_0) \leq \LHS$ and $\RHS \leq p(x_0)$, so 
$\LHS, \RHS < \infty$. Now pick $v \in \R$ such that 
$\LHS \leq v \leq \RHS$. For $x \in M$ and $0 < t \in \R$ we have 
\[
L(x) - tv \leq p(x - t v_0), \qquad 
L(x) + tv \leq p(x + t v_0). 
\]
Now define $\hat{L}: M \oplus \R x_0 \to \R$ by 
$\hat{L}(x + \alpha x_0) = L(x) + \alpha v$. It follows that 
$(M \oplus \R x_0 , \hat{L}) \in P$. However, $(M, L) \prec 
(M \oplus \R, \hat{L})$, a contradiction. Therefore, $M = X$ 
and the proof is complete.

\end{proof}

\begin{thm}[Hahn-Banach theorem in $\C$]
Let $X$ be complex vector space and suppose $p: X \to \R$ 
is such that 
\[
p(\alpha x + \beta y) \leq \abs{\alpha} p(x) + \abs{\beta} p(y)
\]
for all $\alpha, \beta \in \C$ such that $\abs{\alpha} + 
\abs{\beta}=1$ and $x, y \in X$.

Suppose $Y$ subspace of $X$ and $l: Y \to \C$ is a linear map 
such that $\abs{l} \leq p$ on $Y$. Then there exsits linear map 
$L: X \to \C$ such that $\abs{L} \leq p$ on $X$ and  
$L = l$ on $Y$.
\end{thm}

\begin{proof}

Define $\lambda: Y \to \R$ by $\lambda(x) = \Re(l(x))$.
Note that 
\[
\lambda(i x) = \Re(i l(x)) = - \Im(l (x)).
\]
This implies that $l(x) = \lambda(x) - i \lambda(i x)$.
Now treat $X$ and $Y$ as vector space over $\R$ and apply Hahn-Banach
theorem in $\R$ to extend $\lambda$ to $\Lambda : X \to \R$
that agrees with $\lambda$ on $Y$. 

Define $L: X \to \C$ by $L(x) = \Lambda(x) - i \Lambda(i x)$.
It remains to show that $\abs{L} \leq p$. For $x \in X$, 
write $L(x) = \abs{L(x)} e^{i \theta}$ for some $\theta \in \R$.
It follows that 
\[
\begin{aligned}
  \abs{L(x)} 
  &= L(x) e^{- i \theta} \\
  &= \Lambda(e^{- i \theta}) - i \Lambda(i e^{- i \theta} x) \\
  &= \Lambda(e^{- i \theta} x) \\
  &\leq p(e^{- i \theta x}) \\ 
  &\leq \abs{e^{- i \theta}} p(x) \\
  &= p(x),
\end{aligned}
\]
as desired.

\end{proof}

\begin{thm}[Hahn-Banach theorem for bounded linear functionals]
Let $X$ be a normed vector space over $\F$ and $Y$ a subspace 
of $X$. If $\lambda \in Y^*$ then there exists 
$\Lambda \in X^*$ such that $\Lambda = \lambda$ on $Y$ and 
the operator norm 
$\norm{\lambda}_{Y^*} = \norm{\Lambda}_{X^*}$.
\end{thm}

\begin{proof}
  
Consider $p: X \to \R$ where $p(x) = \norm{\lambda}_{Y^*} \norm{x}$.
Apply Hahn-Banach theoerm.

\end{proof}

Next we show some useful implications of Hahn-Banach theorem.

\begin{thm}
Let $X$ be a normed vector space and fix $x \in X$. Then 
the following holds: 
\begin{enumerate}
  \item There exists $\lambda \in X^*$ such that 
  $\norm{\lambda} = \norm{x}$ and 
  \[
  \lambda(x) = \norm{\lambda} \norm{x} = \norm{x}^2.
  \]
  \item We have 
  \[
  \norm{x} = \max_{\substack{w \in X^* \\ \norm{w} = 1}} 
  \abs{w(x)}.
  \]
  \item $x = 0$ if and only if $w(x) = 0$ for all $w \in X^*$.
\end{enumerate}
\end{thm}

\begin{proof}

\begin{enumerate}
\item Let $Y = \F x$ and define $\lambda \in Y^*$ by 
$\lambda(a x) = a \norm{x}^2$. Apply Hahn-Banach theorem.

\item Suppose $x \neq 0$. Define $w = \frac{\lambda}{\norm{x}}$
then it follows that $\abs{w(x)} = \norm{x}$.

\item Follows directly from (2).
\end{enumerate}

\end{proof}

\begin{prop}
Let $X$ be normed vector space. Then the mapping 
$\bra \cdot, \cdot \ket : X^* \times X \to \F$ by 
$(w, x) \mapsto w(x)$ is a bilinear map. That is, 
$\bra \cdot , \cdot \ket \in \L(X^*, X ; \F)$. 
Moreover, 
if $X \neq \left\{ 0 \right\}$, 
then $\norm{\bra \cdot, \cdot \ket}
= 1$.
\end{prop}

\begin{proof}
It is easy to see that $\bra \cdot, \cdot \ket$ is 
bilinear.  For boundedness, 
\[
\abs{\bra w, x \ket} = \abs{w(x)} \leq \norm{w} \norm{x}.
\]
Hence, $\norm{\bra \cdot, \cdot \ket} \leq 1$. Meanwhile, 
pick some $x \in X$ with $\norm{x} = 1$. It follows that 
\[
1 = \norm{x} = \max_{\substack{w \in X^* \\ \norm{w} = 1}}
\abs{w(x)} \leq \norm{\bra \cdot, \cdot \ket}.
\]
Therefore, $\norm{\bra \cdot, \cdot \ket} = 1$.
\end{proof}

\begin{defi}[Norming set]
  Let $X$ be normed vector space and $E \subset X$, 
  $W \subset X^*$. Say $W$ is a \textbf{norming set}
  for $E$ if 
  \[
  \norm{x} = \sup_{\substack{w \in W \\ \norm{w} = 1}} 
  \abs{\bra w, x \ket}
  \]
  for all $x \in E$.
\end{defi}

\begin{prop}

Let $X$ be normed vector space and $S \subset X$ be a 
separable set. Let $W$ be a norming set for $S$. Then, 
there exists $\seqinfn{w_n} \subset W$ such that $\norm{w_n} 
= 1$, and the sequence is norming for $S$. That is, 
\[
\norm{x} = \sup_{n \in \N} \abs{\bra w_n, x \ket}.
\]
\end{prop}

\begin{proof}
  
Let $\seqinfn{v_n} \subset S$ be dense. 
For any $n, k \in \N$, choose $w_{n, k} \in W$ with 
$\norm{w_{n, k}} = 1$ such that 
\[
(1 - 2^{-k}) \norm{v_n} \leq \abs{w_{n, k}, v_n}.
\]
Let $x \in S$ and $0 < \epsilon < 1$ be arbitrary. 
Pick $v_n \in S$ such that $\norm{v_n - x} < \epsilon$ and 
pick $j \in \N$ such that $2^{-j} < \epsilon$. Then, 
\[
\begin{aligned}
(1 - \epsilon) \norm{x} 
&\leq (1 - 2^{-j}) \norm{x}  \\
&\leq (1 - 2^{-j}) \norm{v_n} + (1 - 2^{-j}) \norm{v_n - x} \\
&\leq \abs{\bra w_{n, j}, v_j \ket} + \epsilon \\
&\leq \abs{\bra w_{n, j}, x \ket} + \abs{\bra w_{n, j}, 
x - v_n \ket} + \epsilon \\
&\leq \abs{\bra w_{n, j}, x \ket} + 2 \epsilon.
\end{aligned}
\]
This shows that $\left\{ w_{n, k} \right\}_{n, k = 0}^\infty$
is a norming sequence.

\end{proof}

\begin{thm}
Let $X$ be normed vector space and define $J: X \to X^{**}$ 
by $\braket{Jx}{w} = \braket{w}{x} = w(x)$. Then the following
holds:
\begin{enumerate}
\item $J \in \L(X, X^{**})$. 
\item $J$ is an isometric embedding. In particular, it is 
injective.
\item $\ran(J) \subset X^{**}$ is a norming set for $X^*$.
\item $X$ is Banach if and only if $\ran(J)$ is closed.
\end{enumerate}
\end{thm}

\begin{proof}
Note that we have 
\[
\begin{aligned}
\norm{Jx}_{X^{**}} 
&= \sup \left\{ \abs{\braket{Jx}{w}}: w \in X^* \text{ and } \norm{w} \leq 1 \right\} \\
&= \sup \left\{ \abs{\braket{w}{x}}: w \in X^* \text{ and } \norm{w} \leq 1 \right\} \\
&= \norm{x},
\end{aligned}
\]
where the last step is by a previous theorem that shows 
the existence of $w \in X^*$ such that $\norm{w} = 1$ and 
$\abs{w(x)} = \norm{x}$. This implies (1) and (2).
Now we know $X$ is isometrically isomophic to $\ran(J) \subset 
X^{**}$. Therefore, $X$ is Banach if and only if $\ran(J)$ is 
Banach. However, $X^{**} = \L(X^*, \F)$ is Banach, so 
$\ran(J)$ is Banach if and only if $\ran(J)$ is closed. 
This implies (4).

To show (3), note that we have 
\[
\begin{aligned}
\norm{w}_{X^*} 
&= \sup \left\{ \abs{\braket{w}{x}} : x \in X \text{ and } \norm{x} \leq 1 \right\} \\
&= \sup \left\{ \abs{\braket{Jx}{w}} : x \in X \text{ and } \norm{x} \leq 1 \right\} \\
&= \sup \left\{ \abs{\braket{v}{w}} : v \in \ran(J) \text{ and } \norm{v}_{X^{**}} \leq 1 \right\}.
\end{aligned}
\]
This shows (3), completing the proof.
\end{proof}

\section{Differential Calculus}

\subsection{Inverse and implicit function theorem}

\begin{thm}[Local injectivity theorem]
Let $X$ and $Y$ be Banach spaces, $z \in U \subset X$ 
with $U$ open. Let $f: U \to Y$ differentiable with 
$Df$ continuous at $z$. Suppose $Df(z) \in \L(X; Y)$ 
injective with closed range. Then for any $0 < \epsilon < 1$, 
there exists $r > 0$ such that 
\begin{enumerate}
  \item $B[z, r] \subset U$. 
  \item $Df(x)$ injective with closed range for all $x \in 
  B[z, r]$. 
  \item If $x, y \in B(z, r)$, then 
  \[
  (1 - \epsilon) \norm{Df(z) (x - y)} 
  \leq \norm{f(x) - f(y)} 
  \leq (1 + \epsilon) \norm{Df(z) (x - y)}.
  \]
  \item The restriction $f: B(z, r) \to f(B(z, r))$ 
  is bi-Lipschitz homeomorphism.
\end{enumerate}
\end{thm}

\begin{proof}

Since $Df(z)$ injective with closed range, there exists 
$\theta > 0$ such that 
\[
\theta \norm{h} \leq \norm{Df(z) h}
\]
for all $h \in X$. Since the set of bounded linear operator 
that is injective with closed range is open, there exists 
$\delta > 0$ such that $\norm{Df(z) - T} < \delta$ implies 
$T$ is injective with closed range. 

Now let $0 < \epsilon < 1$. Note that $Df$ 
is continuous at $z$, so we can select $r > 0$ so small 
that $B[z, r] \subset U$, and $x \in B[z, r]$ implies 
\[
\norm{Df(x) - Df(z)} < \min \left\{ \delta, \theta \epsilon \right\}.
\]
In particular, $Df(x)$ is injective with closed range 
for all $x \in B[z, r]$. By the mean value theorem, 
for any $x, y \in B(x, r)$
\[
\begin{aligned}
\norm{f(x) - f(y) - Df(z) (x - y)} 
&\leq \sup_{w \in B(z, r)} \norm{Df(w) - Df(z)} \norm{x - y} \\
&\leq \theta \epsilon \norm{x - y} \\ 
&\leq \epsilon \norm{Df(z) (x - y)}.
\end{aligned}
\]
It follows that 
\[
(1 - \epsilon) \norm{Df(z)(x - y)} 
\leq \norm{f(x) - f(y)} 
\leq (1 + \epsilon) \norm{Df(z) (x - y)},
\]
as desired.

This also implies that 
\[
(1 - \epsilon) \theta \norm{x - y} 
\leq \norm{f(x) - f(y)} \leq (1 + \epsilon)
\norm{Df(z)} \norm{x - y},
\]
so the restriction of $f$ on $B(z, r)$ is a bi-Lipschitz 
homeomorphism.

\end{proof}

\begin{thm}[Local surjectivity theorem]
Let $X$ and $Y$ be Banach spaces, $z \in U \subset X$ with 
$U$ open. Let $f: U \to Y$ differentiable with 
$Df$ continuous at $z$. Suppose $Df(z) \in \L(X; Y)$ 
surjective. Then there exists $r_0, \; \gamma > 0$ such that 
\begin{enumerate}
  \item $B_X[z, r_0] \subset U$. 
  \item $Df(x)$ surjective for all $x \in B_X[z, r_0]$. 
  \item $B_Y[f(z), \gamma r] \subset f(B_X[z, r])$ for all 
  $0 \leq r \leq r_0$.
\end{enumerate}
\end{thm}

\begin{proof}
  
\TODO

\end{proof}

\begin{defi}[diffeomorphism]
Let $X$ and $Y$ be normed vector spaces and suppose that 
$\emptyset \neq U \subset X$ is open. 
Let $f : U \to Y$. For $k \geq 1$, say $f$ is a 
$C^k$ diffeomorphism if 
\begin{enumerate}
  \item $f: U \to f(U)$ homeomorphism with $f(U) \subset Y$
  open. 
  \item $f \in C^k(U ; Y)$.
  \item $f^{-1} \in C^k(f(U); X)$.
\end{enumerate}
If $f$ is a $C^k$ diffeomorphism for all $k \geq 1$,
say $f$ is a smooth diffeomorphism.
\end{defi}

\begin{thm}[Inverse function theorem]
  Let $X$ and $Y$ be Banach spaces, $U \subset X$ open and 
  $x_0 \in U$. Suppose $f: U \to Y$ differentiable, 
  $Df$ continuous at $x_0$, $Df(x_0)$ linear homeomorphism.
  Then there exists bounded and open $V \subset U$ with 
  $x_0 \in V$ such that 
  \begin{enumerate}
    \item $f: V \to f(V)$ is bi-Lipschitz homeomorphism, 
    $Df(x)$ linear homeomorphism for all $x \in V$, 
    $f(V) \subset Y$ bounded and open, $f^{-1} : f(V) \to V$
    differentiable with 
    \[
    Df^{-1}(y) = [Df(f^{-1}(y))]^{-1}
    \]
    for all $y \in f(V)$ and $Df^{-1}$ is continuous 
    at $f(x_0)$. Also, there exists $C_0, \; C_1 > 0$
    such that 
    \[
    C_0 \leq \norm{Df(x)} \leq C_1 
    \]
    for all $x \in V$, and 
    \[
    \frac{1}{C_1} \leq \norm{Df^{-1}(y)} \leq \frac{1}{C_0}
    \]
    for all $y \in f(V)$.
    \item If $f \in C^k(U; Y)$ for some $1 \leq k \leq \infty$,
    then $f^{-1} \in C^k(f(V); X)$. In particular, 
    $f$ is a local $C^k$ diffeomorphism at $x_0$.
    \item If $f \in C^k(U; Y)$ for $1 \leq k \in \N$, then 
    there exists open $V_k \subset V$ such that $x_0 \in V_k$, 
    $f \in C^k_b(V_k ; Y)$ and $f^{-1} \in C^k_b(f(V_k) ; X)$.
  \end{enumerate}
\end{thm}

\begin{proof}
  \TODO
\end{proof}

\begin{thm}[Implicit function theorem]
  Let $X$ and $Y$ be Banach spaces, $U \subset X \times Y$
  be open with $(x_0, y_0) \in U$, and suppose $f: U \to Z$
  is differentiable in $U$ with $Df$ continuous 
  at $(x_0, y_0)$. Further suppose $z_0 = f(x_0, y_0)$
  and $D_2 f(x_0, y_0) \in \L(Y; Z)$ is an isomorphism. 
  Then there exists open sets $x_0 \in V \subset X$, 
  $z_0 \in W \subset Z$, $y_0 \in S \subset Y$, and 
  $g \in C^{0,1}_b (V \times W ; Y)$ such that the following 
  holds:
  \begin{enumerate}
    \item $g(x_0, z_0) = y_0$ and $(x, g(x, z)) \in V \times S 
    \subset U$ for all $(x, z) \in V \times W$. Also, $g$ 
    is differentiable on $V \times W$ and $Dg$ continuous at 
    $(x_0, z_0)$.

    \item $f(x, g(x, z)) = z$ for all $(x, z) \in V \times W$.
    Moreover, if $(x, y) \in V \times S$ such that 
    $f(x, y) = z$ for some $z \in W$, then $y = g(x, z)$.

    \item $D_2 f(x, g(x, z))$ is an isomorphism for all 
    $(x, z) \in V \times W$, and 
    \[
    \begin{aligned}
      D_1 g(x, z) &= - \left[ D_2 f(x, g(x, z)) \right]^{-1} 
      D_1 f (x, g(x, z)), \\
      D_2 g(x, z) &= \left[ D_2 f(x, g(x, z)) \right]^{-1}.
    \end{aligned}
    \]

    \item If $f \in C^k$ then $g \in C^k$ too for $1 \leq k 
    \leq \infty$. If $k$ finite and $f \in C^k_b$ then the 
    sets can be picked such that $g \in C^k_b$.
  \end{enumerate}
\end{thm}

\begin{proof}
  \TODO
\end{proof}


\section{Measure and integration}

\subsection{Introduction to abstrct measure theory}

\subsubsection{Basic definitions}

\begin{defi}
  Let $X$ be a set. 
  \begin{enumerate}
    \item An \textbf{algebra} on $X$ is $\afk \subset 
    \P(X)$ such that 
    \begin{enumerate}
      \item $\emptyset \in \afk$.
      \item $E \in \afk$ implies $E^c \in \afk$.
      \item $E, F \in \afk$ implies $E \cup F \in \afk$.
    \end{enumerate}
    
    \item A \textbf{$\sigma$-algebra} is an algebra 
    $\mf \subset \P(X)$ such that if 
    $E_k \in \mf$ for all $k \in \N$, then 
    $\cupinfk E_k \in \mf$. 

    \item A pair $(X, \mf)$ with $\mf$ a $\sigma$-algebra 
    on $X$ is called a \textbf{measurable space}.
  \end{enumerate}
\end{defi}

\begin{thm}
  Let $X$ be a set.
  \begin{enumerate}
    \item Suppose $A \neq \emptyset$ is a set and 
    $\mf_\alpha$ is $\sigma$-algebra for each $
    \alpha \in A$, then $\mf = \bigcap_{\alpha \in A} 
    \mf_\alpha$ is a $\sigma$-algbera on $X$. 

    \item Suppose $F \subset \P(X)$, there is unique 
    smallest $\sigma$-algebra $\mf$ on $X$ such that 
    $F \subset \mf$. Write $\mf = \sigma(F)$ and call 
    this the $\sigma$-algebra generated by $F$.
  \end{enumerate}
\end{thm}

\begin{thm}
  Let $X$ and $Y$ be sets and $f: X \to Y$.
  \begin{enumerate}
    \item Suppose $\mf$ is a $\sigma$-algebra on $X$ 
    and set 
    \[
    \nf = \left\{ E \subset Y: 
    f^{-1}(E) \in \mf \right\}.
    \]
    Then, $\nf$ is a $\sigma$-algebra on $Y$.
    Call this the \textbf{push-forward} of $\mf$ 
    by $f$.

    \item Suppose $\nf$ is a $\sigma$-algebra 
    on $Y$ and set 
    \[
    \mf = \left\{ f^{-1}(E) : E \in \nf \right\}.
    \]
    Then, $\mf$ is a $\sigma$-algebra on $X$. Call 
    this the \textbf{pull-back} of $\nf$ by $f$.
  \end{enumerate}
\end{thm}

\begin{defi}
  Let $A \neq \emptyset$ be a set. 
  \begin{enumerate}
    \item Let $Y$ be a set and $X_\alpha$ be sets 
    with $\sigma$-algebra $\mf_\alpha$ for all 
    $\alpha \in A$. Suppose $g_\alpha : X_\alpha 
    \to Y$ for all $\alpha \in A$. Define 
    \[
    \sigma \left( \left\{ E \subset Y: g_\alpha^{-1}(E)
    \in \mf_\alpha \text{ for all $\alpha \in A$} 
    \right\} \right)
    \]
    to be the \textbf{push-forward} of $\left\{ g_\alpha 
    \right\}_{\alpha \in A}$.

    \item Let $X$ be a set and $Y_\alpha$ be sets with 
    $\sigma$-algebra $\nf_\alpha$ for all $\alpha \in A$.
    Suppose $f_\alpha : X \to Y_\alpha$ for all $\alpha \in 
    A$. Define 
    \[
    \sigma \left( \left\{ f_\alpha^{-1}(E) : 
    E \in \nf_\alpha \text{ for some $\alpha \in A$} 
    \right\} \right)
    \]
    to be the \textbf{pull-back} of $\left\{ f_\alpha
     \right\}_{\alpha \in A}$.
  \end{enumerate}
\end{defi}

\begin{defi}
  Let $A \neq \emptyset$ be a set and $X_\alpha$ be sets 
  with $\sigma$-algebra $\mf_\alpha$ for all 
    $\alpha \in A$. Then on the set $X = \prod_\alpha X_\alpha$
    we define the \textbf{product $\sigma$-algbera} 
    $\bigoplus_\alpha \mf_\alpha$ to be the 
    pull-back of projection maps 
    $\pi_\alpha : X \to X_\alpha$.
\end{defi}
{
\begin{thm}
  Let $A \neq \emptyset$ be a set and $X_\alpha$ 
  with $\sigma$-algebra $\mf_\alpha$ for all $\alpha 
  \in A$. Let $X = \prod_\alpha X_\alpha$ and 
  define 
  \[
  \mathcal{R} = \left\{ \prod_\alpha M_\alpha: 
  M_\alpha \in \mf_\alpha \right\}.
  \]
  Then, 
  \begin{enumerate}
    \item $\bigoplus_\alpha \mf_\alpha \subset \sigma 
    (\calr)$. If $A$ countable then $\sigma(\calr) 
    = \bigoplus_\alpha \mf_\alpha$.
    
    \item Suppose $\mf_\alpha = \sigma(\cale_\alpha)$
    for all $\alpha \in A$ and let 
    \[
    \cale = \left\{ \pi_\alpha^{-1}(E) : 
    E \in \cale_\alpha \text{ for some $\cale_\alpha$} \right\}.
    \]
    Then $\bigoplus_\alpha \mf_\alpha = \sigma(\cale)$. 
    Moreover, if $A$ is countable and $X_\alpha \in \cale_\alpha$
    for all $\alpha \in A$, then $\bigoplus_\alpha \mf_\alpha$
    is generated by $\calf = \left\{ \prod_\alpha E_\alpha :
    E_\alpha \in \cale_\alpha \right\}$
  \end{enumerate}
\end{thm}

\begin{proof}
\begin{enumerate}
\item For $E \in \mf_\alpha$, we have 
$\pi^{-1}_\alpha (E) = \prod_\beta S_\beta$, where 
\[
S_\beta = \begin{cases}
  E & (\beta = \alpha), \\ 
  X_\beta & (\beta \neq \alpha).
\end{cases}
\]
Then, 
\[
\left\{ \pi_\alpha^{-1}(M_\alpha) : M_\alpha 
\in \mf_\alpha \right\}
\subset \left\{ \prod_\beta M_\beta: M_\beta \in 
\mf_\beta \right\} = \calr.
\]
This implies that $\bigoplus_\alpha \mf_\alpha \subset 
\sigma(\calr)$.

On the other hand, if $A$ is countable, then 
\[
\prod_\alpha M_\alpha = 
\bigcap_\alpha \pi_\alpha^{-1} (M_\alpha) 
\in \bigoplus_\alpha \mf_\alpha
\]
whenever $M_\alpha \in \mf_\alpha$ for all $\alpha \in A$.
This implies that $\sigma(\calr) \subset \bigoplus_\alpha 
\mf_\alpha$.

\item It is clear that $\sigma(\cale) \subset \bigoplus_\alpha 
\mf_\alpha$. On the other hand, for each $\alpha \in A$, let
\[
  \nf_\alpha = \left\{ E \subset X_\alpha : \pi^{-1}_\alpha 
  (E) \in \sigma(\cale) \right\}
\]
be the push-forward 
of $\sigma(\cale)$ to $X_\alpha$ by $\pi_\alpha$. 
It is clear that $\cale_\alpha \subset \nf_\alpha$.
This implies $\mf_\alpha = \sigma(\cale) \subset \nf_\alpha$.
In particular, $\pi_\alpha^{-1}(E) \in \sigma(\cale)$
for all $E \in \mf_\alpha$. This implies that 
$\bigoplus_\alpha \mf_\alpha \subset \sigma(\cale)$.

Now, assume $A$ countable and $X_\alpha \in \cale_\alpha$
for all $\alpha \in A$. Then let $E \in \mf_\alpha$
for some $\alpha \in A$. We have 
$\pi^{-1}_\alpha(E) = \prod_\beta S_\beta$, where 
\[
S_\beta = \begin{cases}
  E & (\beta = \alpha), \\
  X_\beta & (\beta \neq \alpha).
\end{cases}
\]
Therefore, $\sigma(\cale) \subset \sigma(\calf)$. 

On the other hand, since $A$ is countable, we have 
\[
\prod_\alpha E_\alpha = \bigcap_\alpha \pi_\alpha^{-1} 
(E_\alpha) \in \sigma(\cale).
\]
This implies that $\sigma(\calf) \subset \sigma(\cale)$
and the proof is complete.

\end{enumerate}
\end{proof}
}

\begin{cor}
  If $\mf_i$ is $\sigma$-algebra for $i = 1, 2, 3$, then 
  \[
  \mf_1 \oplus (\mf_2 \oplus \mf_3) 
  = (\mf_1 \oplus \mf_2) \oplus \mf_3
  = \mf_1 \oplus \mf_2 \oplus \mf_3,
  \]
  since they are all generated by 
  \[
  \left\{ M_1 \times (M_2 \times M_3) \right\}
  = \left\{ (M_1 \times M_2) \times M_3 \right\}
  = \left\{ M_1 \times M_2 \times M_3 \right\}.
  \]
\end{cor}

\begin{thm}
  Let $X_1, \dots, X_n$ be metric spaces and 
  $X = \prod_{i=1}^n X_i$ be equipped with the ususal 
  metric. Then, $\bigoplus_{i=1}^n \bfk_{X_i} \subset 
  \bfk_X$. However, if each $X_i$ is separable, 
  then $\bfk_X = \bigoplus_{i=1}^n \bfk_{X_i}$.
\end{thm}

\begin{proof}
  We know by the previous theoerm that 
  $\bigoplus_{i=1}^n \bfk_{X_i}$ is generated 
  by $\left\{ \prod_i U_i : U_i \subset X_i \text{ open} 
  \right\}$. However, $\prod_i U_i$ is open in $X$. 
  Therefore, $\bigoplus_{i=1}^n \bfk_{X_i} \subset \bfk_X$.

  Suppose now each $X_i$ is separable and let $D_i \subset X_i$
  be countable and dense. Consider 
  \[
  \cale_i = \left\{ B(x_i, r): \text{ $X_i \in D_i$, 
  $r = \infty$ or $r \in \Q^+$} \right\},
  \]
  which is countable and $\sigma(\cale_i) = \bfk_{X_i}$
  since every open set in $X_i$ is countable union of 
  elements in $\cale_i$. Similarly, $\bfk_X$ is generated
  by $\left\{ \prod_i E_i : E_i \in \cale_i \right\}$. 
  But item 2 from the previous theorem 
  implies that $\bigoplus_{i=1}^n \bfk_{X_i}$
  is generated by the same set. Therefore, 
  $\bigoplus_{i=1}^n \bfk_{X_i} = \bfk_X$.
  
\end{proof}

\begin{remark}
  The above theorem is not true in general 
  if $X_i$ is not separable for some $i$.
\end{remark}

\begin{defi}
  Let $X$ be a metric space. Define 
  \[
  \begin{aligned}
    \fs(X) &= \left\{ \cupinfk C_k : \text{ $C_k \subset X$ 
    closed} \right\}, \\
    \gd(X) &= \left\{ \capinfk U_k : \text{ $U_k \subset X$ 
    open} \right\}.
  \end{aligned}
  \]
  Note that $\fs(X) \subset \bfk_X$ and $\gd(X) \subset 
  \bfk_X$.
\end{defi}

\begin{thm}
  Let $X$ be a metric space. Then the following holds: 
  \begin{enumerate}
    \item $\fs$ and $\gd$ are both closed under finite 
    union and intersection.
    \item If $C \subset X$ is closed, then $C \in \gd$. 
    If $U \subset X$ is open, then $U \in \fs$.
    \item Suppose $X$ is $\sigma$-compact, that is, 
    $X = \cupinfn K_n$ for $K_n \subset X$ compact, 
    then each $F \in \fs$ is also $\sigma$-compact. 
    In particular, all open sets are $\sigma$-compact.
  \end{enumerate}
\end{thm}

\begin{thm}
  Let $X$ and $Y$ be metric spaces and $f: X \to Y$ be 
  continuous. Then the following holds: 
  \begin{enumerate}
    \item $E \in \fs(Y)$ implies that $f^{-1}(E) \in \fs(X)$, 
    and $E \in \gd(Y)$ implies that $f^{-1}(E) \in \gd(X)$.

    \item If $E \in \bfk(Y)$, then $f^{-1}(E) \in \bfk(X)$.
  \end{enumerate}
\end{thm}

\begin{thm}
  Let $X$ and $Y$ be metric spaces with $X$ $\sigma$-compact.
  Then, 
  \begin{enumerate}
    \item If $E \in \fs(X)$ and $f : E \to Y$ is continuous, 
    then $f(E) \in \fs(Y)$ and $\sigma$-compact.

    \item If $f: X \to Y$ is a continuous injection, 
    then $E \in \bfk(X)$ implies $f(E) \in \bfk(Y)$.
  \end{enumerate}
\end{thm}

\begin{cor}
  Let $\emptyset \neq X \subset Y$ for $Y$ a metric space.
  Then $\bfk(X) = \bfk(Y)_X := \left\{ X \cap E: E \in 
  \bfk(Y) \right\}$. 
\end{cor}

\begin{proof}
  We know $V \subset X$ open if and only if $V = X \cap U$
  for some $U$ open in $Y$. 
  Therefore, 
  \[
    \left\{ V \subset X: \text{$V$ open in $X$} 
    \right\} \subset \bfk(Y)_X.
  \]
  This implies that $\bfk(X) \subset \bfk(Y)_X$.

  On the other hand, the inclusion map $I: X \to Y$ is 
  a continuous injection, so if $E \in \bfk(Y)$, then 
  $I^{-1}(E) \in \bfk(X)$. However, $I^{-1}(E) = E \cap X$.
  Therefore, $\bfk(Y)_X \subset \bfk(X)$.

\end{proof}

\subsubsection{Measures}

\begin{defi}[Measure]
  Let $X$ be a set with $\mf$ a $\sigma$-algebra on $X$. 
  A \textbf{measure} is a map $\mu: \nf \to [0, \infty]$
  such that 
  \begin{enumerate}
    \item $\mu(\emptyset) = 0$.
    \item If $\seqinfk{E_k} \subset \mf$ pairwise disjoint,
    then $\mu \left( \cupinfk E_k \right) = \suminfk \mu (E_k)$.
  \end{enumerate}
  Such a triple $(X, \mf, \mu)$ is a \textbf{measure 
  space}.
\end{defi}

\begin{defi}
  We say $(X, \mf, \mu)$ is \textbf{finite} if 
  $\mu(X) < \infty$. We say $(X, \mf, \mu)$ is 
  \textbf{$\sigma$-finite} if $X = \cupinfn X_n$ for 
  $X_n \in \mf$ and $\mu(X_n) < \infty$.
\end{defi}

\begin{thm}
  Let $(X, \mf, \mu)$ be a measure space. Then the 
  following holds: 
  \begin{enumerate}
    \item If $E$ and $F$ is measurable and $E \subset F$, 
    then $\mu(E) \leq \mu(F)$.

    \item If $E_k \in \mf$ for all $k \in \N$, then 
    $\mu \left( \cupinfk E_k \right) \leq \suminfk \mu(E_k)$.
  \end{enumerate}
\end{thm}

\subsubsection{Outer measures and Carath\'eodory construction}

\begin{defi}[Outer measure]
  Let $X$ be a set. An \textbf{outer measure} is a map 
  $\om: \P(X) \to [0, \infty]$ such that 
  \begin{enumerate}
    \item $\om(\emptyset) = 0$.
    \item $E \subset F$ implies $\om(E) \leq \om(F)$.
    \item If $E_k \subset X$ for all $k \in \N$, then 
    $\om \left( \cupinfk E_k \right) \leq \suminfk \om(E_k)$.
  \end{enumerate}
\end{defi}

\begin{prop}
  Let $\om_\alpha: \P(X) \to [0, \infty]$ be an outer 
  measure for all $\alpha \in A \neq \emptyset$. 
  Then $\lambda: \P(X) \to [0, \infty]$ defined by 
  $\lambda(E) = \sup_{\alpha \in A} \om_\alpha(E)$
  is an outer measure.
\end{prop}

\begin{proof}
\begin{enumerate}
  \item $\om_\alpha(\emptyset) = 0$ for all $\alpha \in A$
  implies that $\lambda(\emptyset) = 0$.

  \item Suppose $E \subset F$, then $\om_\alpha(E) 
  \leq \om_\alpha(F) \leq \lambda(F)$ for all $\alpha \in A$.
  Take the sup and we obtain $\lambda(E) \leq \lambda(F)$.

  \item Let $E_k \subset X$ for each $k \in \N$. 
  Then, 
  \[
  \om_\alpha \left( \cupinfk E_k \right) 
  \leq \suminfk \om_\alpha (E_k) 
  \leq \suminfk \lambda(E_k) 
  \]
  This implies that $\lambda(\cupinfk E_k) \leq \suminfk 
  \lambda(E_k)$.
\end{enumerate}
\end{proof}

\begin{defi}
  Let $X$ be a set with outer measure $\om$. Say 
  a set $E \subset X$ is measurable with respect to 
  $\om$ if 
  \[
  \om(A) = \om(A \cap E) + \om(A \cap E^c) 
  \]
  for all $A \subset X$.
\end{defi}

\begin{thm}[Carath\'eodory construction]
  Let $X$ be a set with outer measure $\om$, the following 
  holds. 
  \begin{enumerate}
    \item The collection $\mf = \left\{ E \subset X: \text{ 
      $E$ measurable} \right\}$ 
      is a $\sigma$-algebra.
    \item If $E \subset X$ is such that $\om(E) = 0$, then 
    $E \in \mf$.
    \item The restriction $\mu = \om \vert_\mf$ is a measure, 
    and $(X, \mf, \mu)$ is a complete measure space.
  \end{enumerate}
\end{thm}

\begin{defi}[Cover regular]
  Let $\om$ be an outer measure on $X$. Say $\om$
  is cover-regular if for any $A \subset X$, there 
  exists $E \in \mf$ such that $A \subset E$ 
  and $\om(A) = \mu(E)$.
\end{defi}

\begin{prop}
  Let $\om$ be an outer measure on $X$. Then $\om$
  is outer-regular if and only if for any $A \subset X$, 
  $\om(A) = \inf \left\{ \mu(E) : A \subset E \in 
  \mf \right\}$. In either case, the inf is a min.
\end{prop}

\begin{prop}
  Let $X$ be a set with cover-regular outer measure 
  $\om$. Suppose for $n \in \N$, we have $A_n \subset 
  A_{n+1}$. Then, 
  \[
  \om \left( \cupinfn A_n \right) 
  = \lim_{n \to \infty} \om(A_n).
  \]
\end{prop}

\begin{proof}
  First note that $\om(A_n) \leq \om(A_{n+1}) 
  \leq \om(A)$, where $A = \cupinfn A_n$. 
  Therefore, 
  \[
    \lim_{n \to \infty} \om(A_n) \leq \om(A).
  \]

  On the other hand, by cover regularity, there exists 
  $A_n \subset E_n \in \mf$ such that $\om(A_n) = \mu(E_n)$.
  In particular, $\lim_{n \to \infty} \om (A_n) 
  = \lim_{n \to \infty} \mu(E_n)$. Then, 
  \[
  A = \cupinfn A_n = \cupinfn \bigcap_{k=n}^\infty A_k
  \subset \cupinfn \bigcap_{k=n}^\infty E_k \in \mf,
  \]
  and 
  \[
  \begin{aligned}
    \om(A) 
    \leq \mu \left( \cupinfn 
    \bigcap_{k=n}^\infty E_k \right) 
    = \lim_{n \to \infty} \mu \left( \bigcap_{k=n}^\infty 
    E_k \right) 
    \leq \lim_{n \to \infty} \mu (E_n) 
    = \lim_{n \to \infty} \mu(A_n),
  \end{aligned}
  \]
  where we have used monotone continuity of \textbf{measure}.
  Therefore, $\lim_{n \to \infty} \om (A_n) = \om 
  \left( \cupinfn A_n \right)$.
\end{proof}


\subsubsection{Constructing outer measures}

\begin{defi}
  Let $X$ be a set. A gauge on $X$ is a pair $(\cale, \gamma)$
  where $\cale \subset \P(X)$ is such that $\emptyset 
  \in \cale$ and $\gamma : \cale \to [0, \infty]$ 
  is such that $\gamma(\emptyset) = 0$.
\end{defi}

\begin{thm}
  Let $X$ be a set and $(\cale, \gamma)$ be a gauge on $X$.
  Define $\om: \P(X) \to [0, \infty]$ via 
  \[
  \om(E) = \inf \left\{ \suminfn \gamma(E_n): 
  E \subset \cupinfn E_n \text{ and } 
  \seqinfn{E_n} \subset \cale \right\}.
  \]
  Then $\om$ is an outer measure on $X$ and hence 
  generates $(X, \mf, \mu)$, a complete measure space 
  thorugh Carath\'eodory construction.
\end{thm}

\begin{proof}
  \TODO
\end{proof}

\begin{thm}
  Let $(X, d)$ be a metric space with gauge $(\cale, \gamma)$
  and outer measures $\om_\delta: \P(X) \to [0, \infty]$
  produced by $(\cale_\delta, \gamma_\delta)$ for $\delta > 0$.
  Define $\om_d : \P(X) \to [0, \infty]$ by 
  \[
  \om_d(A) = \sup_{\delta > 0} \om_d (A).
  \]
  Then $\om_d$ is a metric outer measure. Moreover, 
  $\om_d(A) = \lim_{\delta \to 0} \om_\delta(A)$ 
  for $A \subset X$.
\end{thm}

\begin{proof}
  \TODO
\end{proof}

\begin{defi}
  We call $\om_d$ the metric outer measure generated 
  by $(\cale, \gamma)$.
\end{defi}

\begin{lemma}
  Let $X$ be a set with gauge $(\cale, \gamma)$ that covers 
  $X$. Let $A \subset X$, then the following holds:
  \begin{enumerate}
    \item Let $\om$ be the outer measure generated 
    by $(\cale, \gamma)$. Then there exists collection 
    $\left\{ E_{m,n} \right\}_{m, n= 0}^\infty \subset \cale$
    such that $E = \capinfm \cupinfn E_{m, n}$ such that 
    $A \subset E$ and $\om(A) = \om(E)$. 

    \item Suppose $(X, d)$ is metric space and the gauge is 
    fine.
    Let $\om_d$ be the metric outer measure. Then there exists collection 
    $\left\{ E_{m,n} \right\}_{m, n= 0}^\infty \subset \cale$
    such that $E = \capinfm \cupinfn E_{m, n}$ such that 
    $A \subset E$ and $\om(A) = \om(E)$. 
  \end{enumerate}
\end{lemma}

\begin{proof}
The proof for (1) is very similar to the proof for (2), 
so we only show (2) as follows.
Since the gauge is fine, $(\cale_\delta, \gamma_\delta)$
covers $X$ for all $\delta > 0$. Then, for any $m \in \N$,
there exists $\left\{ E_{m, n} \right\}_{n} \subset 
\cale_{2^{-m}}$ such that $A \subset \cupinfn E_{m, n}$ 
and $\suminfn \gamma(E_{m, n}) \leq \om_{2^{-m}}(A) + 2^{-m}$. 
Now let $E = \capinfm \cupinfn E_{m, n}$. Note that 
$A \subset E$ and for any $m \in \N$, we have 
\[
\om_{2^{-m}} (E) \leq \om_{2^{-m}} \left( \cupinfn E_{m, n} \right) 
\leq \suminfn \gamma(E_{m, n}) \leq \om_{2^{-m}} (A) + 2^{-m}.
\]
Taking the limit as $m \to \infty$, we have 
\[
\om_d (E) \leq \om_d(A) \leq \om_d(E),
\]
as desired.

\end{proof}

\begin{thm}
  Let $(X, d)$ be metric space with $(\cale, \gamma)$ such that
  all sets in $\cale$ are open. Assume that $\mu^*$ is a metric 
  outer measure on $X$ such that either 
  
  \begin{enumerate}
    \item $\mu^*$ is generated by $(\cale, \gamma)$, or 
    \item $\mu^* = \mu^*_d$ is generated by $(\cale_\delta, 
    \gamma_\delta)$.
  \end{enumerate}

  Further suppose that $X = \cupinfn A_n$ where $A_n \subset X$
  is such that $\mu^*(A_n) < \infty$. Then the following holds:

  \begin{enumerate}
    \item The gauge covers $X$ in case 1 and is fine in case 
    2. 
    \item In both cases, $\mu^*$ is cover-regular. More precisely,
    for each $A \subset X$, there is $G \in G_\delta(X) \subset \bfk(X)
    \subset \mf$ such that $A \subset G$ and $\mu^*(A) = \mu^*(G)$.
    \item In both cases, the following are equivalent for 
    $E \subset X$: 
    \begin{enumerate}
      \item $E \in \mf$, i.e. $E$ is measurable.
      \item there exists $G \in G_\delta(X)$ such that 
      $E \subset G$ and $\mu^*(G \setminus E) = 0$.
      \item there exists $F \in F_\sigma(X)$ such that 
      $F \subset E$ and $\mu^* (E \setminus F) = 0$.
    \end{enumerate}
  \end{enumerate}
\end{thm}

\begin{proof}

\textbf{Step 0: proof for (1) and (2).} 

We know $X = \cupinfn A_n$ for some $\mu^* 
(A_n) < \infty$. For case (1), we can pick $\left\{ E_{n, m} \right\}
\subset \cale$ 
such that $A_n \subset \bigcup_{m=0}^\infty E_{n, m}$. Then 
$X = \cupinfn A_n = \bigcup_{n, m} E_{n, m}$. Therefore, 
$\cale$ covers $X$.
For case (2), note that $\om_d(A_n) < \infty$ 
and $\om_d(A_n) \geq \om_\delta(A_n)$ 
for each $\delta > 0$ and $n \in \N$.
Then for each $\delta > 0$, 
there exists $\left\{ E_{n, m} \right\} \subset \cale_\delta$
such that $A_n \subset \bigcup_{m=0}^\infty E_{n, m}$.
It follows that
$X = \cupinfn A_n = \bigcup_{n, m} E_{n, m}$. Therefore, 
$(\cale, \gamma)$ is fine.

We have the following observations: 
\begin{enumerate}
  \item $\mu^*$ is a metric outer measure. This implies that 
  $\bfk(X) \subset \mf$. 
  \item $G_\delta(X) \cup F_\sigma(X) \subset \bfk(X) \subset \mf$
  and $\mu^*(A) = 0$ implies $A \in \mf$.
  \item By previous lemma and all sets in $\cale$ are open, 
  we know for each $A \subset X$ there is $E \in G_\delta(X)$
  such that $A \subset E$ and $\mu^*(A) = \mu^*(E)$. 
  In particular, $\mu^*$ is cover regular.
\end{enumerate}

\textbf{Step 1: starting on (3).} 

For (b) $\implies$ (a), suppose (b) holds for $E \subset X$.
Then $E = G \setminus (G \setminus E) \in \mf$ since 
$\om(G \setminus E) = 0$.

For (c) $\implies$ (a), suppose (c) holds for $E \subset X$. 
Then $E = F \cup (E \setminus F) \in \mf$ since 
$\om(E \setminus F) = 0$.

Next we show ``(a) $\implies$ (c)'' implies 
``(a) $\implies$ (b)''. Suppose $E \in \mf$, then 
$E^c \in \mf$. By (a) $\implies$ (b) we know there exists 
$F \in F_\sigma$ such that $F \subset E^c$ and 
$\om(E^c \setminus F) = 0$. Let $G = F^c \in G_\delta$ 
then $E \subset G$ and $G \subset E = E^c \subset F$.

Therefore, it remains to show (a) $\implies$ (c) to complete 
the proof for the theorem. 

\textbf{Step 2: reduction for (a) $\implies$ (c).}

Claim it suffices to show it for $E$ such that $\om(E) < \infty$.
Suppose we did this and $\om(E) = \infty$. Using observation
there exists $B_n \in \mf$ such that $A_n \subset B_n$
and $\om(B_n) = \om (A_n) < \infty$. Then $E_n = E \cap B_n 
\in \mf$ and $\om(E_n) < \infty$. Then by special case there 
is $F_n \in \fs(X)$ such that $F_n \subset E_n$ and 
$\mu^*(F_n \setminus E_n) = 0$. Let $F = \cupinfn F_n \in \fs$
then $F \subset \cupinfn E_n = E$ and 
\[
\om(E \setminus F) \leq \suminfn \om (E_n \setminus F_n) = 0.
\]

\textbf{Step 3: further reduction.}

Claim it suffices to show it for the case where $\om(E) < \infty$
and $E \in \gd(X)$. Suppose we have proved this and consider
$E \subset X$ such that $\om(E) < \infty$. Observation 3 
allows us to pick $G \in \gd(X)$ such that $E \subset G$
and $\om(E) = \om(G)$. Now pick $H \in \gd$ such that $G \setminus E \subset H$
and $\om(H) = \om(G \setminus E)$. 

Now apply special case. This gives $F \in \fs$ such that 
$F \subset G$ and $\om(G \setminus F) = 0$. Let $K = F \setminus H
= F \cap H^c \in \fs$ and $K = F \cap H^c \subset 
G \cap (G \setminus E)^c \subset E$.

Note that $E, F, G, H, K \in \mf$, so 
\[
\begin{aligned}
\om(E \setminus K) 
&= \om(E) - \om(K) \\ 
&= \om(G) - \om(F \setminus H) \\ 
&= \om(G) - \om(F) + \om(F \cap H) \\
&\leq \om(G) - \om(F) + \om(H) \\
&= \om(G \setminus F) + \om(H)  \\
&= \om(G \setminus E) \\
&= \om(G) - \om(E) \\
&= 0.
\end{aligned}
\]
Therefore, $K$ is the desired $\fs$ set.

\textbf{Step 4: finishing (a) $\implies$ (c). }

Suppose $E \in \gd(X)$ and $\om(E) < \infty$. 
Write $E = \cupinfn V_n$ where $V_n \subset X$ open.
For $m, n \in \N$, let 
\[
C_{n, m} = \left\{ x \in V_n: \dist(x, V_n^c) \geq 2^{-m} \right\} 
\subset V_n. 
\]
Note that $C_{n, m}$ is closed, $C_{n, m} \subset C_{n, m+1}$,
$V_n = \bigcup_{m} C_{n, m}$. Since $E, C_{n, m}, V_n \in \mf$,
we have 
\[
\om(E) = \om(E \cap V_n) = \lim_{m \to \infty} \om(E 
\cap C_{n, m}).
\]
Thus, there exists $M(n, k)$ such that 
$\om(E \setminus C_{n, M(n, k)}) < 2^{-n-k}$.
Now let $D_k = \cupinfn C_{n, M(n, k)}$ closed. 
Also, $D_k \subset \cupinfn V_n = E$ and 
\[
\om(E) - \om(D_k) = \om(E \setminus D_k) 
\leq \suminfn \om(E \setminus C_{n, M(n, k)}) \leq 2^{-k+1}.
\]
Let $F = \cupinfk D_k \subset E$ and note that $F \in \fs$.
Then 
\[
\om(E \setminus F) = \om(E) - \om(F) 
\leq \om(E) - \om(D_k) < 2^{-k+1}
\]
for all $k \in \N$. Therefore, $\om(E \setminus F) = 0$.


\end{proof}


\begin{lemma}
Suppose $(X, d)$ metric space with metric outer measure 
$\om$. Suppose $X = \cupinfn V_n$ for $V_n \subset X$ open and 
$\om(V_n) < \infty$. Suppose $E \subset G \in \gd(X)$ such that 
$\om(G \setminus E) = 0$. Then for each $\epsilon > 0$, 
there exists open $U \subset X$ such that $E \subset U$
and $\om(U \setminus E) < \epsilon$.  

\end{lemma}

\begin{proof}

Let $E_n = E \cap V_n$ and $G = G \cap V_n$. Write 
$G = \bigcap_{j=0}^\infty W_j$ where $W_j$ open. 
Now set 
\[
Z_{n, m} = V_n \cap \bigcap_{j=0}^m W_j,
\]
which are open for all $n, m \in \N$.
Now notice that $G_n \subset Z_{n, m+1} \subset Z_{n,m} 
\subset V_n$. Note that $\om(V_n) < \infty$, so 
$\om(G_n) = \lim_{m \to \infty} \om(Z_{n, m})$. Therefore, 
for all $\epsilon > 0$, there exists $M(n)$ such that 
\[
\om(Z_{n, M(n)} \setminus G_n) < \epsilon 2^{-n-2}.
\]
Then set $U = \cupinfn Z_{n, M(n)} \supset \cupinfn G_n = G 
\supset E$ open, then we have 
\[
\begin{aligned}
\om(U \setminus E) 
&= \om(U \setminus G) + \om(G \setminus E)  \\
&= \om \left( \cupinfn Z_{n, M(n)} \cap
\capinfn G_n^c \right) \\
&\leq \suminfn \om(Z_{n, M(n)} \setminus G_n) \\
&< \epsilon,
\end{aligned}
\]
as desired.

\end{proof}


\begin{defi}[Outer-regular]
  Let $X$ be a metric space, $\mf$ a $\sigma$-algebra
  with $\bfk(X) \subset \mf$ and suppose $\mu: \mf \to [0, \infty]$
  is a measure. Say $\mu$ is outer-regular if 
  \[
  \mu(E) = \inf \left\{ \mu(U) : E \subset U \text{ open} \right\}.
  \]
\end{defi}

\subsection{Lebesgue and Hausdorff measure}

\TODO

\subsection{Measurable and $\mu$-measurable functions}

\begin{defi}[Measurable functions]
  Let $(X, \mf)$ and $(Y, \nf)$ be measurable sets. A map 
  $f : X \to Y$ is called $(\mf, \nf)$ measurable if $f^{-1}(E) 
  \in \mf$ for all $E \in \nf$.
\end{defi}

\TODO

\begin{defi}[Simple functions]
  Let $(X, \mf)$ and $(Y, \nf)$ be measurable sets. A map 
  $f : X \to Y$ is called simple if it is 
  measurable and $f(X)$ is finite. Write the set of all 
  simple functions from $X$ to $Y$ as 
  $S(X, Y)$.
\end{defi}

\begin{thm}[Characterization of $\bar{\R}$ measurablility]
  Let $(X, \mf)$ be measure space and $f : X \to \bar{\R}$. The 
  following are equivalent: 
  \begin{enumerate}
    \item $f$ is measurable. 
    \item There exists $\seqinfk{\phi_k} \subset S(X; \bar{\R})$ such that 
    $\phi_k \to f$ pointwise as $k \to \infty$.
  \end{enumerate}
  Moreover, if $f$ is measurable, the sequence can be built such that 
  \begin{itemize}
    \item On the set $\left\{ f \geq 0 \right\}$, we have 
    $0 \leq \phi_k \leq \phi_{k+1} \leq f$.
    \item On the set $\left\{ f < 0 \right\}$, we have 
    $f \leq \phi_{k+1} \leq \phi_k \leq 0$.
    \item If $f$ is actually from $X$ to $\R$ and is bounded, 
    then $\phi_k \to f$ uniformly.
  \end{itemize}
\end{thm}

\begin{proof}
  (2) $\implies$ (1). Pointwise limit of measurable
  functions are measurable.

  (1) $\implies$ (2). Suppose $f : X \to [0, \infty]$
  is measurable. For $k \in \N$, define  
  $\phi_k : [0, \infty)$ by 
  \[
  \phi_k(x) = \begin{cases}
    (j - 1)2^{-k} & \text{ if 
    $(j - 1)2^{-k} \leq f(x) < j 2^{-k}$  
    for $1 \leq j \leq k 2^k$}, \\
    k & \text{ if $f(x) > k$}.
  \end{cases}
  \]
  Because $f$ is measurable, $\phi_k$ is simple for each 
  $k \in \N$. 

  Note that $0 \leq \phi_k \leq \phi_{k+1} \leq f$. Also, 
  if $f(x) < \infty$, then $0 \leq f(x) - \phi_k(x) \leq
  2^{-k}$. If $f(x) = \infty$, then $\phi_k(x) = k$.
  This shows that $\phi_k \to f$. Moreover, 
  if $f$ is bounded then $\phi_k \to f$ uniformly. 

  In the general case, apply the special case to $f$ on 
  $\left\{ f \geq 0 \right\}$ and $-f$ on 
  $\left\{ f < 0 \right\}$.

\end{proof}

\begin{defi}[Separably-valued]
Let $X$ be a set and $Y$ a metric space. A map $f: X 
\to Y$ is \textbf{separably-valued} 
if $f(X) \subset Y$ is separable.
\end{defi}

\begin{thm}
  Let $(X, \mf)$ be measure space and $Y$ be metric space, 
  $f : X \to Y$. The following are equivalent for 
  $f: X \to Y$: 
  \begin{enumerate}
    \item $f$ is $(\mf, \bfk(Y))$ measurable and 
    separably valued.
    \item There exists $\seqinfk{\phi_k} \in S(X; Y)$
    such that $\phi_k \to f$ pointwise.
  \end{enumerate}
\end{thm}

\begin{proof}

(2) $\implies$ (1). The pointwise limit of measurable function 
is measurable. On the other hand, $f(X) = \bar{\cupinfk \phi_k(X)}$,
which is separable since $\phi_k(X)$ finite for any $k \in \N$.

(1) $\implies$ (2). Assume initially that $Y$ is totally bounded.
Then for each $n \in \N$ there exists $y^n_0, \dots, y^n_{K(n)} \in Y$
such that $Y = \bigcup_{k=0}^{K(n)} B(y^n_k, 2^{-n})$. 
Let $V^n_0 = B(y_0^n, 2^{-n})$ and for $k \geq 1$ define
$V^n_k = B(y^n_k, 2^{-n}) \setminus \bigcup_{j=0}^{k-1} 
B(y^n_j, 2^{-n})$. Then, $Y = \bigsqcup_{k=0}^{M(n)} V_k^n$
where $V^n_k = \emptyset$ for $M(n) < k \leq K(n)$.

Define $\phi_n: Y \to \{ y_0^n, \dots, y_{M(n)}^n \}$
via $\phi_n(y) = y_k^n$ if $y \in V_k^n$. Clearly $\phi_n$
is simple and $d(\phi_n(y), y) < 2^{-n}$ for all $n \in \N$
and $y \in Y$. Therefore, $\phi_n(y) \to (y)$ pointwise.
Then $f_n = \phi_n \circ f$ are simple functions
from $X$ to $Y$. Also, since $\phi_n \to \id$ pointwise, 
$f_n \to f$ pointwise.

Now consider the general case in which $f(X)$ is a separable
subset of $Y$. Then there exists a homeomorphism $h: f(X) 
\to Z$ for $Z$ a totally bounded metric space, for example
take $Z$ a subset of Hilbert cube $H^\infty$ since 
all separable metric space is homeomorphism to a subset of 
the Hilbert cube. Thus $h \circ f: X \to Z$ is measurable
with $Z$ totally bounded, so the special case provides 
a sequence $\seqinfn{\phi_n} \subset S(X; Z)$ such that 
$\phi_n \to h \circ f$ pointwise. Then, 
$h^{-1} \circ \phi_n \in S(X; Y)$ is such that 
$h^{-1} \circ \phi_n \to h^{-1} \circ h \circ f = f$
pointwise, using continuity of $h$ and $h^{-1}$.

\end{proof}

\begin{defi}[Almost everywhere]
  
Let $(X, \mf, \mu)$ be a measure space and let 
$P(x)$ be a proposition for every $x \in X$. Say 
$P$ is true \textbf{almost everywhere} (a.e.) if there exists 
a set $N \in \mf$ such that $\mu(N) = 0$ and 
$P(x)$ is true for all $x \in N^c$.

\end{defi}

\begin{thm}
  Let $(X, \mf, \mu)$ be a measure space. Let $Y$ be a 
  metric space, $f: X \to Y$. The following are equivalent:
  \begin{enumerate}
    \item There exists $\seqinfn{\psi_n} \subset S(X; Y)$
    such that $\psi_n \to f$ pointwise a.e. in $X$.
    \item There exists a measurable and separably valued 
    $F : X \to Y$ such that $f = F$ a.e.
    \item There exists a null set $N \in \mf$ and a 
    measurable $F: X \to Y$ such that $f = F$ 
    on $N^c$ and $f(N^c)$ is separable in
    $Y$.
  \end{enumerate}
\end{thm}

\begin{proof}
  
(1) $\implies$ (2). There exists $N \in \mf$ null such that 
$\psi_n \to f$ pointwise in $N^c$. Thus, 
$f: N^c \to Y$ is measurable and separably valued
by the previous theorem. Note the constant map 
$N \ni x \mapsto y \in Y$ for $y \in Y$ fixed is measurable. 
Thus we can define $F : X \to Y$ by 
\[
F(x) = \begin{cases}
  f(x) & (x \in N^c), \\
  y & (x \in N).
\end{cases}
\]
Then $F$ is measurable. It is also separably valued 
since $F(X) = f(N^c) \cup \left\{ y \right\}$.

(2) $\implies$ (3). Trivial.

(3) $\implies$ (1). Note that $F: N^c \to Y$ is measurable
and $F(N^c) = f(N^c)$ is separable.
By previous theorem, there exists $\seqinfn{\phi_n} \in S(N^c; 
Y)$ such that $\phi_n \to F = f$ 
pointwise on $N^c$.
Now let $\psi_n \in S(X; Y)$ be $\phi_n$ in $N^c$ 
and $y \in Y$ fixed in $N$. Then $\psi_n \to f$ pointwise
in $N^c$.

\end{proof}

\begin{defi}
  
Let $(X, \mf)$ be measurable, $Y$ be either a normed vector
space or $\bar{\R}$. Let $\psi \in S(X; Y)$.
\begin{enumerate}
  \item A \textbf{representation} of $\psi$ is a finite and 
  well-defined sum 
  $\psi = \sum_{k=1}^K v_k \chi_{E_k}$ 
  for $v_k \in Y$ and $E_k \in \mf$.
  
  \item A \textbf{canonical representation} is 
  $\psi = \sum_{v \in \psi(X)} v \chi_{\psi^{-1}
  (\left\{ v \right\})}$
  \item Now suppose $\mu$ is a measure.
  We say a representation $\psi = \sum_{k=1}^K 
  v_k \chi_{E_k}$ is \textbf{finite} if $\mu(E_k) < \infty$
  for all $k$ such that $v_k \neq 0$. We 
  say $\psi$ is a \textbf{finite simple function} if it has a 
  finite representation.
  
  We write $\Sfin(X; Y) = \left\{ 
    f \in S(X; Y) : \text{ $f$ is finite}
   \right\}$.
  Note that it is clear $\psi$ is finite if and only if 
  the canonical representation is finite if and only if 
  $\mu(\supp(\psi)) < \infty$ where 
  $\supp(\psi) = \left\{ x \in X : \psi(x) \neq 0 \right\}$
  is the support of $\psi$.
\end{enumerate}

\end{defi}

\begin{defi}
  Let $(X, \mf, \mu)$ be a measure space and $Y$ be a metric 
  space. 
  \begin{enumerate}
    \item We say $f : X \to Y$ is \textbf{almost measurable} 
    if $f = F$ a.e. with $F: X \to Y$ is measurable.
    
    \item We say $f : X \to Y$ is \textbf{almost separably valued}
    if there exists a null set $N \in \mf$ such that 
    $f(N^c)$ is separable.
    
    \item We say $f: X \to Y$ is \textbf{$\mu$-measurable} if 
    it is almost measurable and almost separably valued.
    Equivalently, $f$ is the a.e. limit of simple functions.

    \item Suppose $Y$ is a normed vector space or $\bar{\R}$.
    We say $f: X \to Y$ is \textbf{strongly $\mu$-measurable} 
    if there exists $\seqinfn{\psi_n} \subset \Sfin(X; Y)$
    such that $\psi_n \to f$ a.e. as $n \to \infty$.
  \end{enumerate}
\end{defi}

\begin{eg}
  Let $X = \left\{ 1,2,3 \right\}$ and $\mf = 
  \left\{ \emptyset, \left\{ 1, 2 \right\}, 
  \left\{ 3 \right\}, \left\{ 1, 2, 3 \right\} \right\}$.
  Let $f, g: X \to \R$ via $f(x) = x$ and $g(x) = 3$.
  Then $f$ is not measure since $f^{-1} (\left\{ 1 \right\})
  = \left\{ 1 \right\} \notin \mf$ but $g$ is measurable.

  Now equip $(X, \mf)$ with the measure $\delta_3$.
  Then, $f = g$ a.e. This shows that equality almost 
  everywhere does not preserve measurablility.
  The problem is that $(X, \mf, \delta_3)$ is not 
  \textbf{complete}.
\end{eg}

This brings us to the next theoerm.

\begin{thm}
Let $(X, \mf, \mu)$ be a measure space. Then the following 
are equivalent:
\begin{enumerate}
  \item $(X, \mf, \mu)$ is complete. 
  \item If $(Y, \nf)$ is a measure space, $f, g : X 
  \to Y$, $f$ is measurable and $f = g$ a.e., then 
  $g$ is measurable.
  \item If $Y$ is a metric space with $\card Y = 2$, 
  $f, g: X \to Y$, $f$ measurable, $f = g$ a.e., 
  then $g$ is measurable.
\end{enumerate}  
\end{thm}

\begin{proof}
  
(1) $\implies$ (2). Suppose $f, g: X \to Y$, $f$ is measurable, 
$f = g$ a.e. Pick null set $N \in \mf$ such that 
$f = g$ on $N^c$. Take $E \in \nf$, then 
\[
\begin{aligned}
  g^{-1}(E) 
  &= (g^{-1}(E) \cap N) \cup (g^{-1} (E) \cap N^c) \\
  &= (g^{-1}(E) \cap N) \cup (f^{-1} (E) \cap N^c).
\end{aligned}
\]
Note that $f^{-1}(E) \cap N^c$ is measurable, 
and $g^{-1}(E) \cap N \subset N$ null, so it is also measurable.
Therefore, $g^{-1}(E)$ is measurable and $g$ is measurable.

(2) $\implies$ (3). Clear. 

(3) $\implies$ (1). Prove the contrapositive. 
Suppse $(X, \mf, \mu)$ is not complete and 
$Y = \left\{ y, z \right\}$ a metric space. 
Find $\emptyset \neq A \subsetneq B$ such that 
$\mu(B) = 0$ and $A \notin \mf$. Define $f, g : 
X \to Y$ by 
\[
g(x) = \begin{cases}
  y & (x \notin A), \\
  z & (x \in A).
\end{cases}
\]
and $f(x) = y$ be constant. Then $f = g$ a.e., 
$f$ is measurable, and $g$ is not measurable. 

\end{proof}

\begin{cor}
  Let $(X, \mf, \mu)$ be a complete measurable space,
  $Y$ a separable metric space, and $f: X \to Y$. 
  Then, $f$ is $\mu$-measurable if and only if 
  $f$ is measurable.
\end{cor}

\begin{prop}
  Let $(X, \mf, \mu)$ be a measure space and $Y$ be a metric 
  space. The following holds: 
  \begin{enumerate}
    \item Let $f, g: X \to Y$. If $f$ is $\mu$-measurable
    and $f = g$ a.e., then $g$ is $\mu$-measurable.

    \item Suppose $Y$ is a normed vector space or 
    $\bar{\R}$. If $f, g: X \to Y$, $f$ is strongly 
    $\mu$-measurable, $f = g$ a.e., then 
    $g$ is strong $\mu$-measurable.
  \end{enumerate}
\end{prop}

\begin{proof}
  \begin{enumerate}
    \item Let $\seqinfn{\phi_n} \subset S(X; Y)$ be such that 
    $\phi_n \to g$ pointwise a.e. Pick null set 
    $N \in \mf$ such that $f = g$ on $N^c$. Pick 
    null set $Z \in \mf$ such that $f = \lim_{n \to \infty}
    \phi_n$. This implies that 
    $g = \lim_{n \to \infty} \phi_n$ on $(N \cup Z)^c$. 

    \item Same proof as the first item but let 
    $\seqinfn{\phi_n} \in \Sfin(X; Y)$.
  \end{enumerate}

\end{proof}

\begin{thm}
  Let $(X,\mf, \mu)$ be a measure space and 
  $Y$ be a normed vector space with $V \neq \left\{ 0 
  \right\}$. Then the following are equivalent:
  \begin{enumerate}
    \item $(X, \mf, \mu)$ is $\sigma$-finite.
    \item If $f: X \to Y$ is $\mu$-measurable, then 
    $f$ is strongly $\mu$-measurable.
    \item Let $f: X \to Y$, then $f$ is $\mu$-measurable
    if and only if $f$ is strongly $\mu$-measurable.
    \item If $y \in Y \setminus \left\{ 0 \right\}$, 
    then $f: X \to Y$ via $f(x) = y$ strongly 
    $\mu$-measurable.
  \end{enumerate}
\end{thm}

\begin{proof}
  (1) $\implies$ (2). Suppose $(X, \mf, \mu)$ is 
  $\sigma$-finite. We can find $\seqinfn{X_n} 
  \subset \mf$ such that $X_n \subset X_{n+1}$, 
  $\mu(X_n) < \infty$ and $\cupinfn X_n = X$. 
  Let $f: X \to Y$ be $\mu$-measurable. Pick 
  $\seqinfn{\psi_n} \subset S(X; Y)$ such that
  $\psi_n \to f$ pointwise a.e. Define 
  $\phi_n = \chi_{X_n} \psi_n$. This shows that 
  $f$ is strongly $\mu$-measurable.

  (2) $\iff$ (3). Trivial since strongly $\mu$-measurablility
  implies $\mu$-measurablility.

  (2) $\implies$ (4). Constant function are $\mu$-measurable.

  (4) $\implies$ (1). Let $y \in Y \setminus \left\{ 0 \right\}$
  and define $f : X \to Y$ via $f(x) = y$. This 
  is strongly $\mu$-measurable by assumption. 
  Then there exists $\seqinfn{\phi_n} \subset \Sfin(X; Y)$ 
  such that $\phi_n \to f$ pointwise on $N^c$ where 
  $N$ is null. 

  Pick $\epsilon > 0$ such that $\left\{ 0 \right\} 
  \cap B(y, \epsilon) = \emptyset$. Set 
  $X_n = \phi_n^{-1} (B(y, \epsilon))$. Then we have 
  $\mu(X_n) < \infty$. For any $x \in N^c$ and $n$ 
  sufficiently large, $\phi_n(x) \in B(y, \epsilon)$.
  Therefore, $N^c \subset \cupinfn X_n$ and 
  the proof we are complete.

\end{proof}

Finally, we present a useful characterization of 
$\mu$-measurablility of Banach-valued maps. 

\begin{thm}[Pettis]
  Let $(X, \mf, \mu)$ be a measure space and $V$ be a 
  Banach space over $\F$. Suppose $W \subset V^*$ is a 
  norming subspace. Let $f: X \to V$. Then the following
  are equivalent:
  \begin{enumerate}
    \item $f$ is $\mu$-measurable.
    \item $f$ is almost separably valued, and $w \circ
    f : X \to \F$ is $\mu$-measurable for each $w \in V^*$.
    \item $f$ is almost separably valued, and $w \circ f: 
    X \to \F$ is $\mu$-measurable for each $w \in W$.
  \end{enumerate}
  In any case, there exists $\seqinfn{\phi_n} \subset S(X; V)
  $ such that $\norm{\phi_n} \leq 2 \norm{f}$ on $X$ such that 
  $\phi_n \to f$ pointwise a.e. as $n \to \infty$. 
  Moreover, the same 
  equivalence holds with $\mu$-measurablility replaced by 
  stronly $\mu$-measurablility and $\seqinfn{\phi_n}$  
  replaced by $\seqinfn{\phi_n} \subset \Sfin(X; V)$.
\end{thm}

\begin{proof}
  (1) $\implies$ (2). Suppose $f$ is $\mu$-measurable, 
  which means it is almost separably valued.
  Each $w \in V^*$ is also continuous so 
  $w \circ f$ is $\mu$-measurable.

  (2) $\implies$ (3). Trivial since $W \subset V^*$.
  
  (3) $\implies$ (1). Suppose $f$ is almost separably valued.
  Then there exists null set $N_* \subset X$ such that 
  $f(X \setminus N_*) \subset V$ separable. Define the subspace 
  \[
  M = \spn(f(X \setminus N_*)) \subset V,
  \] 
  which is separable by construction. Pick a dense 
  set $\seqinfm{v_n} \subset M$ such that $v_0 = 0$. 
  Then by a previous theorem, we know there exists
  a norming sequence $\seqinfn{w_n} \subset W$ for $M$.
  
  Now, given any $v \in V$ and $n \in \N$, define 
  the function $\Phi_{n, v} : X \to [0, \infty)$ 
  by 
  \[
  \Phi_{n, v}(x) = \abs{\braket{w_n}{f(x) - v}}
  = \abs{w_n(f(x) - v)}.
  \]
  Note that $X \ni x \mapsto \braket{w_n}{v} \in \F$ is 
  $\mu$-measurable and the map $X \ni x \mapsto 
  \braket{w_n}{f(x)} \in \F$ is also $\mu$-measurable
  by assumption. It follows that 
  $\Phi_{n, v}$ is $\mu$-measurable. Therefore, 
  there exists null set $N_{n, v} \subset X$ and 
  a measurable map $\Psi_{n, v} : X \to [0, \infty)$
  such that $\Psi_{n, v} = \Phi_{n, v}$ on $X \setminus 
  N_{n, v}$. For each $v \in V$ define null set 
  \[
  N(v) = N_* \cup \cupinfn N_{n, v} \subset X,
  \]
  with $\Psi_{n, v} = \Phi_{n, v}$ on $X \setminus N(v)$
  for all $n \in \N$. 

  For $v \in M$ define the map $\Phi_v : X \to [0, \infty]$
  by $\Phi_v(x) = \norm{f(x) - v}$ and note that 
  $\seqinfn{w_n}$ is norming sequence for $M$. 
  This implies that 
  \[
  \Phi_v(x) = \sup_{n \in \N} \abs{\braket{w_n}{f(x) - v}}
  \]
  for all $x \in X \setminus N_*$. We also have that 
  \[
  \Phi_v(x) = \sup_{n \in \N} \Phi_{n, v}(x) 
  = \sup_{n \in \N} \Psi_{n, v}(x)
  \]
  for all $x \in X \setminus N(v)$, so $\Phi_v$ 
  is measurable when restricted to $X \setminus N(v)$.
  We can then define the set 
  \[
  N = \cupinfm N(v_m) \subset X, 
  \]
  which is null. By construction, each $\Phi_{v_m}$
  is measurable when restricted to $N^c$. 
  In particular, $\Phi_0 = \Phi_{v_0} = \norm{f}$ 
  is measurable when restricted to $N^c$.

  For $u \in M$ and $n \in \N$, define 
  \[
  k(n, u) = \min \left\{ 0 \leq k \leq n :
  \norm{u - v_k} = \min_{0 \leq j \leq n} 
  \norm{u - v_j} \right\}.
  \]
  By construction, 
  \[
  \norm{v_{k(n, u)}} 
  \leq \norm{u - v_{k(n, m)}} + \norm{u}
  \leq \norm{u - v_0} + \norm{u} 
  = 2\norm{u}.
  \]
  We then define $S_n: M \to \left\{ v_0, \dots, v_n
  \right\}$ via $S_n(u) = v_{k(n, u)}$. Note that 
  $\norm{S_n(u)} \leq 2 \norm{u}$. Also, 
  $\seqinfm{v_m}$ dense in $M$ implies
  $S_n(u) \to u$ as $n \to \infty$. 

  Finally, for $n \in \N$, define $\psi_n: N^c 
  \to \left\{ v_0, \dots, v_n \right\} \subset V$
  via $\psi_n = S_n \circ f$. 
  For $0 \leq k \leq n$, we compute 
  \[
  \begin{aligned}
    &
    \left\{ x \in N^c: \psi_n(x) = v_k \right\} \\
    &= \left\{ x \in N^c: 
    \norm{f(x) - v_k} = \min_j \norm{f(x) - v_j} \right\}
    \cap \bigcap_{j=0}^{k-1} 
    \left\{ x \in N^c: 
    \norm{f(x) - v_k} < \norm{f(x) - v_j} \right\}
  \end{aligned}
  \]
  This set is measurable since $\Phi_{v_m}$ measurable 
  on $N^c$ for each $m \in \N$. 
  It follows that $\psi_n$ is measurable on $N^c$.
  Let $\phi_n \in S(X; V)$ by 
  \[
  \phi_n(x) = \begin{cases}
    \psi_n(x) & (x \in N^c), \\
    0 & (x \in N).
  \end{cases}
  \]
  Then, $\norm{\phi_n} \leq 2\norm{f}$ 
  and $\phi_n(x) = \psi_n(x) \to f(x)$ as 
  $n \to \infty$ for $x \in N^c$. 
  Therefore, $\phi_n \to f$ a.e. and thus 
  $f$ is $\mu$-measurable.

\end{proof}

\subsection{Lebesgue-Bochner Integral}

\begin{lemma}
  Let $(X, \mf, \mu)$ be a measure space and 
  $Y \in \left\{ V, [0, \infty] \right\}$. 
  Let $\psi: X \to Y$ be simple such that 
  \[
  \psi = \sum_{i=1}^I \alpha_i \chi_{E_i} 
  = \sum_{j=1}^J \beta_j \chi_{F_j}.
  \]
  Additionally, if $Y = V$ suppose both representation
  are finite. Then, 
  \[
  \sum_{i=1}^I \alpha_i \mu(E_i) = \sum_{j=1}^J 
  \beta_j \mu(F_j).
  \]

  Based on this lemma, we can define
  \[
  \int_X \psi \d\mu = \sum_{i=1}^I \alpha_i \mu(E_i).
  \]
  This induces maps $\int_X \cdot \d \mu: S(X; [0, 
  \infty]) \to [0, \infty]$ and $\int_X \cdot \d \mu 
  : \Sfin(X; V) \to V$.
\end{lemma}

\begin{prop}
  Let $(X, \mf, \mu)$ be a measure space and 
  $Y \in \left\{ V, [0, \infty] \right\}$.
  Then the following holds: 
  \begin{enumerate}
    \item If $Y = V$, then 
    \[
      \int_X (\alpha f + \beta g) \d \mu 
      = \alpha \int_X f \d \mu + \beta \int_X
      g \d \mu
    \]
    for all $\alpha, \beta \in \F$ and 
    $f, g \in \Sfin(X ; V)$. 
    If $Y = [0, \infty]$, the same equality holds 
    for any $\alpha, \beta > 0$ and $f, g \in S(X; V)$.

    \item If $Y = V$, then 
    $\norm{f} \in \Sfin(X; [0, \infty))$ 
    and 
    \[
      \norm{\int_X f \d\mu} \leq \int_X \norm{f} \d\mu.
    \]
    
    \item If $E \in \mf$, then 
    \[
      \int_E f \d \mu = \int_X f \chi_E \d \mu.
    \]

    \item If $N \in \mf$ is a null set, then 
    \[
      \int_N f \d \mu = 0.
    \]

    \item If $A, B \in \mf$ is such that 
    $A \cap B = \emptyset$,
    then 
    \[
    \int_{A \cup B} f \d\mu = \int_A f \d\mu
    + \int_B f \d\mu.
    \]

    \item Suppose $\seqinfn{X_n} \subset \mf$ is such that 
    $X_n \subset X_{n+1}$ and $\mu(X_n) < \infty$. 
    Then 
    \[
      \int_X f \d \mu = \lim_{n \to \infty} 
      \int_{X_n} f \d\mu.
    \]

    \begin{proof}
      Write $f = \sum_k f_k \chi_{E_k}$ be the canonical 
      representation. We then have 
      \[
      \int_{X_n} f \d\mu = \sum_k f_k \mu(X_n \cap E_k).
      \]
      For each $k$, we have 
      $X_n \cap E_k \subset X_{n+1} \cap E_k$ and 
      $\cupinfn (X_n \cap E_k) = E_k$. 
      It follows that
      \[
        \lim_{n \to \infty} \mu(X_n \cap E_k) 
        = \mu(E_k).
      \]
      Therefore, 
      \[
      \lim_{n \to \infty} \int_{X_n} f \d\mu
      = \sum_k f_k \mu(E_k) = \int_X f \d\mu.
      \]

    \end{proof}

    \item If $Y = \R$ or $Y = [0, \infty]$ and 
    $f \leq g$ a.e., then 
    \[
    \int_X f \d\mu \leq \int_X g \d\mu.
    \]
  \end{enumerate}
\end{prop}

\subsubsection*{Integral of $\bar{\R}$-valued functions}

Note that if $(X, \mf, \mu)$ is a measure space and 
$\phi \in S(X; [0, \infty])$, then 
\[
\int_X \phi \d\mu = 
\sup \left\{ \int_X \psi \d\mu : 
\psi \in S(X; [0, \infty]) \text{ and $\psi \leq \phi$
a.e.} \right\}.
\]

\begin{defi}
  Let $(X, \mf, \mu)$ be a measure space. Let 
  $f : X \to [0, \infty]$ be $\mu$-measurable. We 
  define 
  \[
  \int_X f \d\mu = 
  \sup \left\{ \int_X \psi \d\mu: 
  \text{$\psi \in S(X; [0, \infty])$ and 
  $\psi \leq f$ a.e.} \right\} 
  \in [0, \infty].
  \]

  We say $f$ is \textbf{integrable} if $\int_X f \d \mu < 
  \infty$.
\end{defi}

\begin{remark}
There are two remarks with regard to the definition 
above.
\begin{enumerate}
  \item In principle we do not need $f$ to be $\mu$-measurable
  here. We build this into the definition because the 
  resulting integral is more-or-less useless without this 
  assumption. 
  \item $[0, \infty]$ is a separable metric space,
  so for $f : X \to [0, \infty]$, 
  $f$ is measurable implies $f$ is $\mu$-measurable,
  and $f$ almost measurable implies $f$ is $\mu$-measurable.
\end{enumerate}
\end{remark}

\begin{thm}
Let $(X, \mf, \mu)$ be a measure space, $f, g : X \to [0, \infty]$
be $\mu$-measurable functions. The following holds: 
\begin{enumerate}
  \item For $\alpha \in [0, \infty)$, we have 
  \[
  \int_X \alpha f \d \mu = \alpha \int_X f \d \mu.
  \]
  \item If $f \leq g$ a.e., then 
  \[
  \int_X f \d \mu \leq \int_X g \d \mu.
  \]
  \item If $f = g$ a.e., then 
  \[
  \int_X f \d \mu = \int_X g \d \mu.
  \]
  \item For $E \in \mf$, we have 
  \[
  \int_E f \d \mu = \int_X f \chi_E \d \mu.
  \]
  \item If $N \in \mf$ is null, then 
  \[
  \int_N f \d \mu = 0.
  \]
\end{enumerate}
\end{thm}

\begin{proof}
Follow directly from corresponding results in $S(X; [0, \infty])$
and the definition of $\int_X f \d \mu$.
\end{proof}

\begin{thm}[Monotone convergence theorem, basic version]
Let $(X, \mf, \mu)$ be a measure space and suppose for 
each $n \in \N$, we have $f_n : 
X \to [0, \infty]$ \textbf{measurable}. Further suppose 
that $f_n \leq f_{n+1}$ on $X$ and $f: X \to [0, \infty]$
is given by $f = \lim_{n \to \infty} f_n$. Then 
$f$ is measurable and 
\[
\int_X f \d \mu = \lim_{n \to \infty} \int_X f_n \d \mu
= \sup_{n \in \N} \int_X f_n \d \mu.
\]
\end{thm}

\begin{proof}
We already know $f$ is measurable. Also, $f_n \leq f_{n+1}
\leq f$ on $X$, so 
\[
\int_X f_n \d \mu \leq \int_X f_{n+1} \d \mu \leq 
\int_X f \d \mu.
\]
It follows that 
\[
\lim_{n \to \infty} \int_X f_n \d \mu \leq \int_X f \d \mu.
\]
To show the opposite inequality, let 
$\phi \in S(X; [0, \infty])$ such that $\phi \leq f$ a.e.
and $\alpha \in (0, 1)$. Let $N \in \mf$ be a null set 
and $\phi \leq f$ on $N^c$. Also, for each $n \in \N$, let 
$E_n = \left\{ x \in X : f_n(x) \geq \alpha \phi(x) \right\}$.
Note the following:
\begin{enumerate}
  \item Since $f_n \leq f_{n+1}$, we have $E_n \subset E_{n+1}$.
  \item Since $f_n \to f$ pointwise, we have $X = N \cup \cupinfn
  E_n$.
  \item We have 
  \[
  \alpha \int_{N \cup E_n} \phi \d \mu 
  = \int_{E_n} \alpha \phi \d \mu 
  \leq \int_{E_n} f_n \d \mu
  \leq \int_X f_n \d \mu
  \]
  \item We have 
  \[
  \int_X \phi \d \mu
  = \lim_{n \to \infty} \int_{N \cap E_n} \phi \d \mu.
  \]
\end{enumerate}
Therefore, 
\[
\alpha \int_X \phi \d \mu 
= \lim_{n \to \infty} \alpha \int_{N \cup E_n} \phi \d \mu
\leq \lim_{n \to \infty} \int_X f_n \d \mu.
\]
Since the above inequality holds for all $\alpha \in (0, 1)$,
we konw $\int_X \phi \d \mu \leq \lim_{n \to \infty} 
\int_X f_n \d \mu$. This is then true for all simple function 
$\phi$ such that $\phi \leq f$ a.e. Taking the sup 
gives 
\[
\int_X f \d \mu \leq \lim_{n \to \infty} f_n \d \mu.
\]
The proof is then complete.
\end{proof}

\begin{thm}
Let $(X, \mf, \mu)$ be measure space, $f, g : X \to [0, \infty]$
be $\mu$-measurable. Then 
\[
\int_X (f + g) \d \mu = \int_X f \d \mu + \int_X g \d \mu.
\]
\end{thm}

\begin{proof}
Recall that $\mu$-measurable functions are almost 
measurable. Choose measurable functions 
$F, G : X \to [0, \infty]$ such that $f = F$
and $g = G$ a.e. We may then choose 
$\seqinfn{\phi_n}, \seqinfn{\psi_n} \subset S(X; [0, \infty])$
such that $\lim_{n \to \infty} \phi_n = F$
and $\lim_{n \to \infty} \psi_n = G$, 
$0 \leq \phi_n \leq \phi_{n+1} \leq F$
and $0 \leq \psi_n \leq \psi_{n+1} \leq G$. 
Then 
\[
0 \leq \phi_n + \psi_n \leq \phi_{n+1} + \psi_{n+1} 
\leq F + G = \lim_{n \to \infty} (\phi_n + \psi_n).
\]
It follows then from monotone convergence theorem that 
\[
\begin{aligned}
\int_X (F + G) \d \mu 
&= \lim_{n \to \infty} \int_X (\phi_n + \psi_n) \d \mu \\
&= \lim_{n \to \infty} \int_X \phi_n \d \mu 
+ \lim_{n \to \infty} \int_X \psi_n \d \mu \\ 
&= \int_X F \d \mu + \int_X G \d \mu.
\end{aligned}
\]
Since $f = F$ and $g = G$ a.e., we have 
\[
\int_X (f + g) \d \mu = \int_X f \d \mu + \int_X g \d \mu.
\]
\end{proof}

\textbf{Recall:} given $f: X \to \bar{\R}$, 
we write $f^{\pm} : X \to [0, \infty]$ via 
\[
f^+ = \max\left\{ 0, f \right\}, \quad 
f^- = \max\left\{ 0, -f \right\}.
\]
Then we have $f = f^+ - f^-$ and 
$\abs{f} = f^+ + f^-$. Also, if $f$ is measurable or 
$\mu$-measurable, then $f^\pm$ is also measurable or
$\mu$-measurable since they are composition of a 
continuous function (namely $x \mapsto \max \{0, x\}$)
with a measurable or $\mu$-measurable
function.

\begin{defi}
Let $(X, \mf, \mu)$ be measure space and 
$f : X \to \bar{\R}$ be $\mu$-measurable. 
If either $f^+$ or $f^-$ is \textbf{integrable}, 
we say $f$ is \textbf{extended integrable} and 
set 
\[
\int_X f \d \mu = \int_X f^+ \d \mu - \int_X f^- \d \mu
\in \bar{\R}.
\]
We say $f$ is \textbf{integrable} if $f^\pm$ are both 
integrable.
\end{defi}

\begin{prop}[absolute integrability]
Let $(X, \mf, \mu)$ be a measure space, $f : X \to \bar{\R}$
be $\mu$-measurable. Then $f$ is integrable 
if and only if $\abs{f}$ is integrable.
\end{prop}

\begin{proof}
We know $f$ is integrable if and only if $f^\pm$
are both integrable, but $\abs{f} = f^+ + f^-$.
Therefore, $f$ integrable implies $\abs{f}$ is integrable.
Conversely, if $\abs{f}$ is integrable, then 
$0 \leq f^\pm \leq \abs{f}$, so $f^\pm$ are both 
integrable.
\end{proof}

\begin{thm}
Let $(X, \mf, \mu)$ be a measure space, 
$f, g : X \to \bar{\R}$ are extended integrable. 
The following holds: 
\begin{enumerate}
  \item For all $E \in \mf$, we have $\int_E f \d \mu
  = \int_X f \chi_E \d \mu$. 
  
  \item For all $\alpha \in \R$, we have 
  $\alpha \int_X f \d \mu = \int_X \alpha f \d \mu$. 
  
  \item $\int_X (f + g) \d \mu = \int_X f \d \mu + 
  \int_X g \d \mu$, provided that all operations are 
  well-defined.

  \item $\int_{A \cup B} f \d \mu = \int_A f \d \mu 
  + \int_B f \d \mu$ for all $A, B \in \mf$ such that 
  $A \cap B = \emptyset$. 

  \item If $f \leq g$ a.e. then $\int_X f \d \mu \leq
  \int_X g \d \mu$.

  \item $\abs{\int_X f \d \mu} \leq \int_X \abs{f} \d \mu$.
  
  \item If $\abs{f} \leq g$ a.e. and $g$ integrable, then 
  $f$ is integrable. 
\end{enumerate}
\end{thm}

\begin{thm}[Chebyshev inequality]
If $f$ is measurable, then 
\[
\mu \left( \left\{ x \in X : \abs{f(x)} \geq \alpha \right\} \right) 
\leq \frac{1}{\alpha} \int_X \abs{f} \d \mu
\]
for all $\alpha \in (0, \infty)$.
\end{thm}

\begin{proof}
\[
\begin{aligned}
  \LHS = \int_{\left\{ \abs{f} \geq \alpha \right\}} 1 \d \mu 
  = \int_{\left\{ \abs{f} \geq \alpha \right\}} 
  \frac{\abs{f}}{\alpha} \d \mu 
  = \frac{1}{\alpha} \int_X \abs{f} \d \mu 
  = \RHS.
\end{aligned}
\]
\end{proof}

\begin{cor}
Let $(X, \mf, \mu)$ be a measure space and $f: X \to \bar{\R}$.
\begin{enumerate}
  \item If $f$ is integrable, then there exists 
  a null set $N \in \mf$ and a $\sigma$-finite set $E \in \mf$
  such that 
  $\left\{ \abs{f} = \infty \right\} \subset N$ 
  and $\supp(f) \subset E$.

  \item If $f$ is extended integrable, then there 
  exsits a null set $N \in \mf$ such that 
  either $\left\{ f = \infty \right\} \subset N$
  or $\left\{ f = -\infty \right\} \subset N$.
\end{enumerate}
\end{cor}

\begin{proof}
\begin{enumerate}
  \item Suppose initially that $f$ is measurable and integrable, 
  then Chebyshev inequality implies that 
  \[
  \mu \left( \left\{ \abs{f} = \infty \right\} \right) 
  \leq \mu \left( \left\{ \abs{f} > 2^k \right\} \right) 
  \leq 2^{-k} \int_X \abs{f} \d \mu
  \]
  for all $k \in \N$. It follows that 
  $\mu \left\{ \abs{f} = \infty \right\}$ is null. 
  
  On the other hand, $\supp(f) = \cupinfk \left\{ \abs{f} 
  > 2^{-k} \right\}$, but 
  \[
  \mu \left( \left\{ \abs{f} > 2^{-k} \right\} \right) 
  \leq 2^k \int_X \abs{f} \d \mu < \infty.
  \]
  It follows that $\supp(f)$ is $\sigma$-finite. 
  
  In general, if $f$ is integrable and $\mu$-measurable, 
  pick $F = f$ a.e. for $F$ measurable and integrable and 
  apply the argument above.

  \item Next, if $f$ is extended integrable but not integrable, 
  then either $f^+$ is integrable or $f^-$ is integrable.
  If $f^+$ is integrable, then $\{f = +\infty\}$ is 
  contained in some null set. If $f^-$ is integrable, 
  $\{f = -\infty\}$ is contained in a null set.
\end{enumerate}
\end{proof}

\begin{thm}[Monotone convergence theorem, general form]
\TODO
\end{thm}

\begin{proof}
Homework.
\end{proof} 

\begin{cor}
\begin{enumerate}
  \item Let $(X, \mf, \mu)$ be a measure space, $f_k : X \to (-\infty, \infty]$
  be $\mu$-measurable for all $k \in \N$ and $f_k \geq 0$ a.e. 
  Then, 
  \[
  \int_X \suminfk f_k \d \mu = \suminfk \int_X f_k \d \mu.
  \]
  
  \item Suppose $(X, \mf, \mu)$ is a measure space, $X = \cupinfk E_k$
  such that $\seqinfk{E_k} \subset \mf$ and $\mu \left( E_k \cap E_j \right)
  = 0$ for all $k \neq j$. Given $f: X \to [0, \infty]$
  $\mu$-measurable, we then have 
  \[
  \int_X f \d \mu = \suminfk \int_{E_k} f \d \mu.
  \]
\end{enumerate}
\end{cor}

\begin{proof}
\begin{enumerate}
  \item Note that $\supp(f_k^-)$ is in a null set, so each $f_k$ is 
  extended integrable. The same holds for $\suminfk f_k : 
  X \to [-\infty, \infty]$. On the other hand, the partial sums 
  $\sumk^m f_k \leq \sumk^{m+1} f_k$ a.e. Apply monotone 
  convergence theorem gives the desired equality.

  \item Use the first claim on $f_k = f \chi_{E_k}$.
\end{enumerate}
\end{proof}

\begin{thm}[Fatou's lemma]
  \TODO 
\end{thm}

\begin{proof}
Note that $\int_X g \d \mu > - \infty$ implies $g^-$ is 
integrable. Write 
\[
  f = \liminf_{k \to \infty} f_k,
\]
which is 
a $\mu$-measurable function. Then, $g \leq f_k$ a.e. implies 
$g \leq f$ a.e. as well. It follows that $-f_k \leq -g$
and $-f \leq -g$. Therefore, 
$f_k^- \leq g^-$ and $f^- \leq g^-$.
This shows that 
$f_k, f$ are extended-integrable. Next, note that 
\[
\int_X g \d \mu \leq \int_X \inf_{j \geq k} f_j \d \mu 
\leq \int_X f_k \d \mu.
\]
By monotone convergence theoerm, we know the middle term 
converges when $k$ approaches infinity. 
Taking the liminf, we have 
\[
\int_X g \d \mu 
\leq \lim_{k \to \infty} \int_X 
\inf_{j \geq k} f_j \d \mu 
= \liminf_{k \to \infty} f_k \d \mu
\leq \liminf_{k \to \infty} \int_X f_k \d \mu.
\]
\end{proof}

\begin{thm}[Dominated convergence theorem]
\TODO
\end{thm}

\begin{proof}
We know $\abs{f_k} \leq g_k$ a.e., $g_k \to g$ a.e., 
and $f_k \to f$ a.e. Then, $\abs{f} \leq g$ a.e., 
so $f_k$ and $f$ are integrable. 
In turn, we can use a previous corollary to pick $N \in \mf$
null such that $f_k, f, g_k, g$ are all $\R$-valued 
and all assumed inequalities hold on $N^c$. 
Then, $\abs{f - f_k} \leq g + g_k$ on $N^c$, and so 
\[
0 \leq g + g_k - \abs{f - f_k}.
\]
Apply Fatou's lemma, we then have 
\[
\begin{aligned}
\int_{N^c} 2g \d \mu 
&= \int_{N^c} \liminf_{k \to \infty} (g + g_k - \abs{f - f_k}) 
\d \mu  \\
&\leq \liminf_{k \to \infty} \int_{N^c} (g + g_k - \abs{f - f_k})
\d \mu \\
&= \liminf_{k \to \infty} \int_{N^c} - \abs{f - f_k} \d \mu
+ \int_{N^c} 2g \d \mu.
\end{aligned}
\]
It follows that
\[
0 \leq \limsup_{k \to \infty} \int_{N^c} \abs{f - f_k} \d \mu
= - \liminf_{k \to \infty} \int_{N^c} - \abs{f - f_k} \d \mu
\leq 0.
\]
Therefore, 
\[
\lim_{k \to \infty} \int_{N^c} \abs{f - f_k} \d \mu = 0.
\]
This then implies 
\[
\lim_{k \to \infty} \int_X f_k \d \mu = \int_X f \d \mu.
\]
\end{proof}



\newpage
\subsection{Constructing product measures}

\begin{defi}[Pre-measure]
Let $X$ be a set and $\afk$ be an algebra on $X$. A map 
$\gamma: \afk \to [0, \infty]$ is a \textbf{pre-measure}
if the following is satisfied:
\begin{enumerate}
  \item $\gamma(\emptyset) = 0$. 
  \item If $\seqinfi{A_i} \subset \afk$ is disjoint and 
  $\cupinfi A_i$, then $\gamma \left( \cupinfi A_i \right)
  = \suminfi \gamma(A_i)$.
\end{enumerate}

\end{defi}

\begin{thm}[Pre-measure extension theorem]
Let $X$ be a set, $\afk$ is an algebra on $X$, and 
$\gamma$ a pre-measure. Let $\om : \P (X) \to [0, \infty]$
be the outer measure constructed from $(X, \gamma)$.
Denote $\mf$ as the the measurable space and 
$\mu: \mf \to [0, \infty]$ the corresponding measure.
Then the following holds: 
\begin{enumerate}
  \item $\afk \subset \mf$ and $\mu = \gamma$ on $\afk$.
  
  \item Suppose $\nf$ is a $\sigma$-algebra on $X$ 
  such that $\afk \subset \nf \subset \mf$, and 
  $\nu: \nf \to [0, \infty]$ is a measure such that 
  $\nu = \gamma$ on $\afk$. Then $\nu \leq \mu$ on $\nf$
  and $\nu(E) = \mu(E)$ whenever $E$ is $\sigma$-finite 
  w.r.t. $\mu$. 
  
  In particular, if $X$ is ``$\gamma$ $\sigma$-finite'',
  then $\mu = \nu$ on $\nf$.
\end{enumerate}
\end{thm}

\begin{proof}
First show $\mu = \gamma$ on $\afk$. 
It suffices to show that $\om = \gamma$ on $\afk$.

For any $E \in \afk$, we know $E$ is covered by $E$, so 
$\om = \gamma$. On the other hand, let $E \subset \afk$
and $\seqinfk{A_k} \subset \afk$ be a cover of $E$.
Define $B_0 = E \cap A_0 \in \afk$ and 
$B_k = E \cap (A_k \setminus \cupi^{k-1} A_k) \in \afk$.
Then $\seqinfk{B_k}$ is pairwise disjoint and 
$\cupinfk B_k = E$. It follows that 
\[
\gamma(E) = \gamma \left( \cupinfk B_k \right)
= \suminfk \gamma(B_k) \leq \suminfk \gamma(A_k).
\]
Therefore, $\om = \gamma$ on $\afk$. 

Next we show $\afk \subset \mf$. Let $E \in \afk$
be arbitrary and we want to show $\om(A) 
= \om(A \cap E) + \om (A \cap E^c)$ for all 
$A \subset X$. Fix arbitrary $A \subset X$ and 
$\epsilon > 0$. Pick $\seqinfk{A_k} \subset \afk$
covering $A$ such that 
\[
\suminfk \gamma (A_k) < \om(A) + \epsilon.
\]
It follows that 
\[
\begin{aligned}
\om(A \cap E) + \om(A \cap E^c) 
&\leq \om \left( \cupinfk A_k \cap E \right)
+ \om \left( \cupinfk A_k \cap E^c \right) \\ 
&\leq \suminfk \om(A_k \cap E) + \om(A_k \cap E^c) \\
&= \suminfk \gamma(A_k \cap E) + \gamma(A_k \cap E^c) \\
&= \suminfk \gamma(A_k).
\end{aligned}
\]
This implies that $E$ is measurable, completing the proof 
for the first item.

For the second item, we first show that $\nu \leq \mu$.
Let $E \in \nf \subset \mf$ and $\seqinfk{A_k} \subset \afk$ 
that covers $E$. It follows that 
\[
\nu(E) \leq \nu \left( \cupinfk A_k \right)
= \lim_{n \to \infty} \nu \left( \cupi^n A_i \right).
\]
Note that $\cupi^n A_i \in \afk$, so 
$\nu \left( \cupi^n A_i \right) = \mu \left( \cupi^n 
A_i \right)$. This implies that 
\[
\nu(E) = \lim_{n \to \infty} \mu \left( \cupi^n A_i \right)
= \mu \left( \cupinfk A_k \right) \leq \suminfk \gamma(A_k).
\]
Therefore, $\nu \leq \mu$. 

Next we show $\nu(E) = \mu(E)$ for $\mu(E) < \infty$. 
Let $\epsilon > 0$ and select $\seqinfk{A_k} \subset \afk$
covering $E$ such that 
\[
\suminfk \gamma(A_k) < \om(E) + \epsilon = \mu(E) + \epsilon.
\]
Then, 
\[
\mu \left( \cupinfk A_k \right) 
\leq \suminfk \gamma(A_k) < \mu(E) + \epsilon.
\]
It follows that $\mu \left( \cupinfk A_k \setminus E \right)
< \epsilon$ and thus 
\[
\begin{aligned}
\mu(E) 
\leq \mu \left( \cupinfk A_k \right) 
= \nu \left( \cupinfk A_k \right) 
= \nu (E) + \nu \left( \cupinfk A_k \setminus E \right)
\leq \nu(E) + \epsilon,
\end{aligned}
\]
where for $\mu \left( \cupinfk A_k \right)
= \nu \left( \cupinfk A_k \right)$ we used the same limit argument 
as the previous part.

For the case where $E$ is $\sigma$-finite, it follows from 
a similar argument.

\end{proof}

\begin{thm}[Product measures]
Let $2 \leq n \in \N$ and suppose $(X_i, \mf_i, \mu_i)$
is measure space for $1 \leq i \leq n$. Let 
$X = \prod_i X_i$ and 
\[
\cale = \left\{ E = \prod_i E_i : 
\text{$E_i \in \mf_i$ for $1 \leq i \leq n$} \right\}.
\]
The following holds: 
\begin{enumerate}
\item $\afk = \left\{ \cupk^K A^k : 
\text{$\left\{ A^k \right\}_k \subset \cale$ and disjoint} 
\right\}$ is an algebra.

\item Suppose $\seqinfk{E^k} \cale$ and 
$\seqinfk{F^k} \subset \cale$ are both pairwise disjoint sequences 
of sets and $\cupinfk{E^k} = \cupinfk{F^k}$, then 
\[
\suminfk \prod_{i=1}^n \mu_i(E_i^k) = 
\suminfk \prod_{i=1}^n \mu_i(F_i^k).
\]

\item The map $\gamma: \afk \to [0, \infty]$ defined by 
\[
\gamma \left( \cupk^K \prod_{i=1}^n E_i^k \right)
= \sumk^K \prod_{i=1}^n \mu_i(E_i^k)
\]
is a well-defined pre-measure.
\end{enumerate}
\end{thm}

\begin{proof}
\begin{enumerate}
\item It is easy to check that $\afk$ is indeed an algebra.
\item Suppose $\cupinfk E^k = \cupinfk F^k$, then we have 
\[
\suminfk \prod_{i=1}^n \chi_{E_i^k}(x_i) 
= \suminfk \prod_{i=1}^n \chi_{F_i^k}(x_i)
\]
for all $x = (x_1, \dots, x_n) \in X$. 
Now fix $(x_2, \dots, x_n)$, we then have 
\[
\suminfk \chi_{E^k_1}(x_1) \alpha_1^k 
= \suminfk \chi_{F^k_1}(x_1) \beta_1^k, 
\]
where 
$\alpha_1^k = \prod_{i=2}^n \chi_{E_i^k} (x_i)$ and 
$\beta_1^k = \prod_{i=2}^n \chi_{F_i^k} (x_i)$.
Using the monotone convergence theorem and integrate 
both sides, we have 
\[
\suminfk \mu_1(E_1) \alpha_1^k 
= \suminfk \mu_1(F_1) \beta_1^k.
\]
Iterate this argument gives the desired equality.

\end{enumerate}
\end{proof}


\end{document}